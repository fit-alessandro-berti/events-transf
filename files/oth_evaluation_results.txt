!# RECEIPT PHASE LOG

# Foundation Model

--- üöÄ Initializing Test Run with Configuration ---
Loading training config from ./checkpoints/training_config.pth to match model...
  - Test Log: Found direct path: logs/receipt.xes
  - Test Mode: retrieval_augmented
  - Test Episodes: 200
  - Checkpoint Directory: ./checkpoints
  - Checkpoint Epoch: Latest
  - Retrieval K-values: [1, 5, 10, 20]
  - Retrieval Candidate %: [5, 20, 100]
--- Running Testing Script in Stand-Alone Mode (strategy: 'learned') ---
Using device: cuda

üì¶ Loading test data...
Data loader initialized with strategy: 'learned'
‚úÖ Training artifacts loaded successfully from ./checkpoints/training_artifacts.pth
Transforming log: 'receipt' from /home/berti/events-transf/logs/receipt.xes

Transforming logs: ['receipt']
‚úÖ Transformation complete.
‚úÖ Initialized MoEModel with 4 expert(s).
Character vocabulary set in LearnedEventEmbedder.
Character vocabulary set in LearnedEventEmbedder.
Character vocabulary set in LearnedEventEmbedder.
Character vocabulary set in LearnedEventEmbedder.
üîç Found latest checkpoint: model_epoch_10.pth
üíæ Loading weights from ./checkpoints/model_epoch_10.pth...

üõ†Ô∏è Creating test tasks...

--- Running in Retrieval-Augmented Evaluation Mode ---

üî¨ Starting Retrieval-Augmented Evaluation...
  - (MoE) Running k-NN eval for all 4 experts.
  - [Expert 0] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 0] Case ID stats: unique_cases=1318, total_tasks=5825
  - [Expert 0] Top case_id counts: [(np.str_('case-9289'), 23), (np.str_('case-8323'), 22), (np.str_('case-4978'), 16), (np.str_('case-6335'), 16), (np.str_('case-891'), 16)]
  - [Expert 0] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.4010 | inter_centroid_cos=0.3449 | centroid_margin=0.1176 | knn_purity@5=0.7360 knn_purity@10=0.7050
  - [Expert 0] Pre-computed 5825 embeddings for classification.
  - [Expert 0] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 0] Case ID stats: unique_cases=1318, total_tasks=5825
  - [Expert 0] Top case_id counts: [(np.str_('case-9289'), 23), (np.str_('case-8323'), 22), (np.str_('case-4978'), 16), (np.str_('case-6335'), 16), (np.str_('case-891'), 16)]
  - [Expert 0] Pre-computed 5825 embeddings for regression.
  - [Expert 1] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 1] Case ID stats: unique_cases=1318, total_tasks=5825
  - [Expert 1] Top case_id counts: [(np.str_('case-9289'), 23), (np.str_('case-8323'), 22), (np.str_('case-4978'), 16), (np.str_('case-6335'), 16), (np.str_('case-891'), 16)]
  - [Expert 1] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.4207 | inter_centroid_cos=0.3621 | centroid_margin=0.1580 | knn_purity@5=0.7414 knn_purity@10=0.7141
  - [Expert 1] Pre-computed 5825 embeddings for classification.
  - [Expert 1] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 1] Case ID stats: unique_cases=1318, total_tasks=5825
  - [Expert 1] Top case_id counts: [(np.str_('case-9289'), 23), (np.str_('case-8323'), 22), (np.str_('case-4978'), 16), (np.str_('case-6335'), 16), (np.str_('case-891'), 16)]
  - [Expert 1] Pre-computed 5825 embeddings for regression.
  - [Expert 2] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 2] Case ID stats: unique_cases=1318, total_tasks=5825
  - [Expert 2] Top case_id counts: [(np.str_('case-9289'), 23), (np.str_('case-8323'), 22), (np.str_('case-4978'), 16), (np.str_('case-6335'), 16), (np.str_('case-891'), 16)]
  - [Expert 2] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.4143 | inter_centroid_cos=0.2677 | centroid_margin=0.1927 | knn_purity@5=0.7338 knn_purity@10=0.7091
  - [Expert 2] Pre-computed 5825 embeddings for classification.
  - [Expert 2] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 2] Case ID stats: unique_cases=1318, total_tasks=5825
  - [Expert 2] Top case_id counts: [(np.str_('case-9289'), 23), (np.str_('case-8323'), 22), (np.str_('case-4978'), 16), (np.str_('case-6335'), 16), (np.str_('case-891'), 16)]
  - [Expert 2] Pre-computed 5825 embeddings for regression.
  - [Expert 3] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 3] Case ID stats: unique_cases=1318, total_tasks=5825
  - [Expert 3] Top case_id counts: [(np.str_('case-9289'), 23), (np.str_('case-8323'), 22), (np.str_('case-4978'), 16), (np.str_('case-6335'), 16), (np.str_('case-891'), 16)]
  - [Expert 3] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.3903 | inter_centroid_cos=0.3317 | centroid_margin=0.1909 | knn_purity@5=0.7176 knn_purity@10=0.6958
  - [Expert 3] Pre-computed 5825 embeddings for classification.
  - [Expert 3] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 3] Case ID stats: unique_cases=1318, total_tasks=5825
  - [Expert 3] Top case_id counts: [(np.str_('case-9289'), 23), (np.str_('case-8323'), 22), (np.str_('case-4978'), 16), (np.str_('case-6335'), 16), (np.str_('case-891'), 16)]
  - [Expert 3] Pre-computed 5825 embeddings for regression.
  - Inter-expert metrics (classification) Expert 0 vs Expert 1: mean_cos=-0.0993 | mean_l2=1.4825 | centroid_cos_mean=-0.1436
  - Inter-expert metrics (classification) Expert 0 vs Expert 2: mean_cos=-0.0062 | mean_l2=1.4185 | centroid_cos_mean=-0.0029
  - Inter-expert metrics (classification) Expert 0 vs Expert 3: mean_cos=0.0710 | mean_l2=1.3624 | centroid_cos_mean=0.0156
  - Inter-expert metrics (classification) Expert 1 vs Expert 2: mean_cos=0.0673 | mean_l2=1.3657 | centroid_cos_mean=0.0687
  - Inter-expert metrics (classification) Expert 1 vs Expert 3: mean_cos=-0.0342 | mean_l2=1.4380 | centroid_cos_mean=-0.0087
  - Inter-expert metrics (classification) Expert 2 vs Expert 3: mean_cos=-0.0507 | mean_l2=1.4495 | centroid_cos_mean=-0.0518
  - Inter-expert metrics (regression) Expert 0 vs Expert 1: mean_cos=-0.0993 | mean_l2=1.4825
  - Inter-expert metrics (regression) Expert 0 vs Expert 2: mean_cos=-0.0062 | mean_l2=1.4185
  - Inter-expert metrics (regression) Expert 0 vs Expert 3: mean_cos=0.0710 | mean_l2=1.3624
  - Inter-expert metrics (regression) Expert 1 vs Expert 2: mean_cos=0.0673 | mean_l2=1.3657
  - Inter-expert metrics (regression) Expert 1 vs Expert 3: mean_cos=-0.0342 | mean_l2=1.4380
  - Inter-expert metrics (regression) Expert 2 vs Expert 3: mean_cos=-0.0507 | mean_l2=1.4495

--- Evaluating task: classification | Expert 0 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 292 / 5825
[Expert 0 | 1-NN | pct=5%] Retrieval Accuracy: 0.6600 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 0 | 5-NN | pct=5%] Retrieval Accuracy: 0.6550 | Avg. Confidence: 0.5188 (on 200 queries)
[Expert 0 | 10-NN | pct=5%] Retrieval Accuracy: 0.6150 | Avg. Confidence: 0.3574 (on 200 queries)
[Expert 0 | 20-NN | pct=5%] Retrieval Accuracy: 0.6050 | Avg. Confidence: 0.2719 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 1165 / 5825
[Expert 0 | 1-NN | pct=20%] Retrieval Accuracy: 0.7200 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 0 | 5-NN | pct=20%] Retrieval Accuracy: 0.7500 | Avg. Confidence: 0.6258 (on 200 queries)
[Expert 0 | 10-NN | pct=20%] Retrieval Accuracy: 0.7450 | Avg. Confidence: 0.4561 (on 200 queries)
[Expert 0 | 20-NN | pct=20%] Retrieval Accuracy: 0.6750 | Avg. Confidence: 0.3226 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 0 | 1-NN | pct=100%] Retrieval Accuracy: 0.8000 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 0 | 5-NN | pct=100%] Retrieval Accuracy: 0.8150 | Avg. Confidence: 0.7495 (on 200 queries)
[Expert 0 | 10-NN | pct=100%] Retrieval Accuracy: 0.7550 | Avg. Confidence: 0.6191 (on 200 queries)
[Expert 0 | 20-NN | pct=100%] Retrieval Accuracy: 0.7650 | Avg. Confidence: 0.4956 (on 200 queries)
  - [Expert 0] RF (classification, 80/20): Accuracy=0.7888 (n=1165)

--- Evaluating task: classification | Expert 1 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 292 / 5825
[Expert 1 | 1-NN | pct=5%] Retrieval Accuracy: 0.6500 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 1 | 5-NN | pct=5%] Retrieval Accuracy: 0.6800 | Avg. Confidence: 0.5213 (on 200 queries)
[Expert 1 | 10-NN | pct=5%] Retrieval Accuracy: 0.6600 | Avg. Confidence: 0.3857 (on 200 queries)
[Expert 1 | 20-NN | pct=5%] Retrieval Accuracy: 0.6050 | Avg. Confidence: 0.3029 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 1165 / 5825
[Expert 1 | 1-NN | pct=20%] Retrieval Accuracy: 0.7350 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 1 | 5-NN | pct=20%] Retrieval Accuracy: 0.7500 | Avg. Confidence: 0.6269 (on 200 queries)
[Expert 1 | 10-NN | pct=20%] Retrieval Accuracy: 0.7550 | Avg. Confidence: 0.4701 (on 200 queries)
[Expert 1 | 20-NN | pct=20%] Retrieval Accuracy: 0.6300 | Avg. Confidence: 0.3524 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 1 | 1-NN | pct=100%] Retrieval Accuracy: 0.8000 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 1 | 5-NN | pct=100%] Retrieval Accuracy: 0.8000 | Avg. Confidence: 0.7475 (on 200 queries)
[Expert 1 | 10-NN | pct=100%] Retrieval Accuracy: 0.7900 | Avg. Confidence: 0.6099 (on 200 queries)
[Expert 1 | 20-NN | pct=100%] Retrieval Accuracy: 0.7350 | Avg. Confidence: 0.5033 (on 200 queries)
  - [Expert 1] RF (classification, 80/20): Accuracy=0.8069 (n=1165)

--- Evaluating task: classification | Expert 2 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 292 / 5825
[Expert 2 | 1-NN | pct=5%] Retrieval Accuracy: 0.6200 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 2 | 5-NN | pct=5%] Retrieval Accuracy: 0.6250 | Avg. Confidence: 0.5000 (on 200 queries)
[Expert 2 | 10-NN | pct=5%] Retrieval Accuracy: 0.5500 | Avg. Confidence: 0.3894 (on 200 queries)
[Expert 2 | 20-NN | pct=5%] Retrieval Accuracy: 0.5400 | Avg. Confidence: 0.2932 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 1165 / 5825
[Expert 2 | 1-NN | pct=20%] Retrieval Accuracy: 0.7000 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 2 | 5-NN | pct=20%] Retrieval Accuracy: 0.7150 | Avg. Confidence: 0.6496 (on 200 queries)
[Expert 2 | 10-NN | pct=20%] Retrieval Accuracy: 0.7050 | Avg. Confidence: 0.4801 (on 200 queries)
[Expert 2 | 20-NN | pct=20%] Retrieval Accuracy: 0.6100 | Avg. Confidence: 0.3489 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 2 | 1-NN | pct=100%] Retrieval Accuracy: 0.8100 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 2 | 5-NN | pct=100%] Retrieval Accuracy: 0.8100 | Avg. Confidence: 0.7504 (on 200 queries)
[Expert 2 | 10-NN | pct=100%] Retrieval Accuracy: 0.7550 | Avg. Confidence: 0.6237 (on 200 queries)
[Expert 2 | 20-NN | pct=100%] Retrieval Accuracy: 0.7100 | Avg. Confidence: 0.5097 (on 200 queries)
  - [Expert 2] RF (classification, 80/20): Accuracy=0.8043 (n=1165)

--- Evaluating task: classification | Expert 3 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 292 / 5825
[Expert 3 | 1-NN | pct=5%] Retrieval Accuracy: 0.6300 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 3 | 5-NN | pct=5%] Retrieval Accuracy: 0.6400 | Avg. Confidence: 0.5248 (on 200 queries)
[Expert 3 | 10-NN | pct=5%] Retrieval Accuracy: 0.6200 | Avg. Confidence: 0.3913 (on 200 queries)
[Expert 3 | 20-NN | pct=5%] Retrieval Accuracy: 0.5250 | Avg. Confidence: 0.2925 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 1165 / 5825
[Expert 3 | 1-NN | pct=20%] Retrieval Accuracy: 0.7600 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 3 | 5-NN | pct=20%] Retrieval Accuracy: 0.7450 | Avg. Confidence: 0.5997 (on 200 queries)
[Expert 3 | 10-NN | pct=20%] Retrieval Accuracy: 0.7100 | Avg. Confidence: 0.4484 (on 200 queries)
[Expert 3 | 20-NN | pct=20%] Retrieval Accuracy: 0.6600 | Avg. Confidence: 0.3334 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 3 | 1-NN | pct=100%] Retrieval Accuracy: 0.8100 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 3 | 5-NN | pct=100%] Retrieval Accuracy: 0.8100 | Avg. Confidence: 0.7441 (on 200 queries)
[Expert 3 | 10-NN | pct=100%] Retrieval Accuracy: 0.7650 | Avg. Confidence: 0.6149 (on 200 queries)
[Expert 3 | 20-NN | pct=100%] Retrieval Accuracy: 0.7400 | Avg. Confidence: 0.4840 (on 200 queries)
  - [Expert 3] RF (classification, 80/20): Accuracy=0.7957 (n=1165)

--- Evaluating task: regression | Expert 0 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 292 / 5825
[Expert 0 | 1-NN | pct=5%] Retrieval MAE: 140.8581 | R-squared: -0.8786 | Avg. Confidence: 1.0000
[Expert 0 | 5-NN | pct=5%] Retrieval MAE: 99.9695 | R-squared: -0.1563 | Avg. Confidence: 0.3148
[Expert 0 | 10-NN | pct=5%] Retrieval MAE: 98.4953 | R-squared: -0.1702 | Avg. Confidence: 0.1791
[Expert 0 | 20-NN | pct=5%] Retrieval MAE: 98.6938 | R-squared: -0.2043 | Avg. Confidence: 0.0923

  - Candidate pool sampling: 20%
  - Candidate pool size: 1165 / 5825
[Expert 0 | 1-NN | pct=20%] Retrieval MAE: 227.8985 | R-squared: -21.1900 | Avg. Confidence: 1.0000
[Expert 0 | 5-NN | pct=20%] Retrieval MAE: 93.3467 | R-squared: -0.0660 | Avg. Confidence: 0.3326
[Expert 0 | 10-NN | pct=20%] Retrieval MAE: 95.6150 | R-squared: -0.1398 | Avg. Confidence: 0.1927
[Expert 0 | 20-NN | pct=20%] Retrieval MAE: 97.4611 | R-squared: -0.1912 | Avg. Confidence: 0.1013

  - Candidate pool sampling: 100%
[Expert 0 | 1-NN | pct=100%] Retrieval MAE: 177.1175 | R-squared: -10.3296 | Avg. Confidence: 1.0000
[Expert 0 | 5-NN | pct=100%] Retrieval MAE: 87.7930 | R-squared: 0.0495 | Avg. Confidence: 0.3275
[Expert 0 | 10-NN | pct=100%] Retrieval MAE: 87.8804 | R-squared: 0.0012 | Avg. Confidence: 0.1911
[Expert 0 | 20-NN | pct=100%] Retrieval MAE: 90.1920 | R-squared: -0.0387 | Avg. Confidence: 0.1011
  - [Expert 0] RF (regression, 80/20): MAE=88.4239 | RMSE=92.4807 | R2=0.0410 (cases=827 | samples=1165)

--- Evaluating task: regression | Expert 1 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 292 / 5825
[Expert 1 | 1-NN | pct=5%] Retrieval MAE: 120.9512 | R-squared: -0.9134 | Avg. Confidence: 1.0000
[Expert 1 | 5-NN | pct=5%] Retrieval MAE: 97.0727 | R-squared: -0.1199 | Avg. Confidence: 0.3192
[Expert 1 | 10-NN | pct=5%] Retrieval MAE: 97.5522 | R-squared: -0.1474 | Avg. Confidence: 0.1833
[Expert 1 | 20-NN | pct=5%] Retrieval MAE: 97.8694 | R-squared: -0.1862 | Avg. Confidence: 0.0930

  - Candidate pool sampling: 20%
  - Candidate pool size: 1165 / 5825
[Expert 1 | 1-NN | pct=20%] Retrieval MAE: 217.8544 | R-squared: -20.7588 | Avg. Confidence: 1.0000
[Expert 1 | 5-NN | pct=20%] Retrieval MAE: 90.5734 | R-squared: -0.0154 | Avg. Confidence: 0.3351
[Expert 1 | 10-NN | pct=20%] Retrieval MAE: 93.7887 | R-squared: -0.0847 | Avg. Confidence: 0.1941
[Expert 1 | 20-NN | pct=20%] Retrieval MAE: 96.6471 | R-squared: -0.1528 | Avg. Confidence: 0.1015

  - Candidate pool sampling: 100%
[Expert 1 | 1-NN | pct=100%] Retrieval MAE: 196.6613 | R-squared: -12.2586 | Avg. Confidence: 1.0000
[Expert 1 | 5-NN | pct=100%] Retrieval MAE: 91.3741 | R-squared: -0.0486 | Avg. Confidence: 0.3261
[Expert 1 | 10-NN | pct=100%] Retrieval MAE: 86.2503 | R-squared: -0.0023 | Avg. Confidence: 0.1907
[Expert 1 | 20-NN | pct=100%] Retrieval MAE: 87.1731 | R-squared: -0.0053 | Avg. Confidence: 0.1004
  - [Expert 1] RF (regression, 80/20): MAE=87.8613 | RMSE=91.9515 | R2=0.0454 (cases=827 | samples=1165)

--- Evaluating task: regression | Expert 2 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 292 / 5825
[Expert 2 | 1-NN | pct=5%] Retrieval MAE: 137.5423 | R-squared: -1.1709 | Avg. Confidence: 1.0000
[Expert 2 | 5-NN | pct=5%] Retrieval MAE: 97.6249 | R-squared: -0.1328 | Avg. Confidence: 0.3175
[Expert 2 | 10-NN | pct=5%] Retrieval MAE: 96.6019 | R-squared: -0.1445 | Avg. Confidence: 0.1797
[Expert 2 | 20-NN | pct=5%] Retrieval MAE: 97.6225 | R-squared: -0.1877 | Avg. Confidence: 0.0920

  - Candidate pool sampling: 20%
  - Candidate pool size: 1165 / 5825
[Expert 2 | 1-NN | pct=20%] Retrieval MAE: 168.9436 | R-squared: -11.0250 | Avg. Confidence: 1.0000
[Expert 2 | 5-NN | pct=20%] Retrieval MAE: 90.8387 | R-squared: -0.0373 | Avg. Confidence: 0.3316
[Expert 2 | 10-NN | pct=20%] Retrieval MAE: 93.3468 | R-squared: -0.0907 | Avg. Confidence: 0.1923
[Expert 2 | 20-NN | pct=20%] Retrieval MAE: 95.1163 | R-squared: -0.1467 | Avg. Confidence: 0.1020

  - Candidate pool sampling: 100%
[Expert 2 | 1-NN | pct=100%] Retrieval MAE: 139.7023 | R-squared: -5.0977 | Avg. Confidence: 1.0000
[Expert 2 | 5-NN | pct=100%] Retrieval MAE: 88.7882 | R-squared: -0.0119 | Avg. Confidence: 0.3211
[Expert 2 | 10-NN | pct=100%] Retrieval MAE: 87.1195 | R-squared: -0.0132 | Avg. Confidence: 0.1885
[Expert 2 | 20-NN | pct=100%] Retrieval MAE: 89.5573 | R-squared: -0.0478 | Avg. Confidence: 0.1015
  - [Expert 2] RF (regression, 80/20): MAE=88.4632 | RMSE=92.5188 | R2=0.0428 (cases=827 | samples=1165)

--- Evaluating task: regression | Expert 3 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 292 / 5825
[Expert 3 | 1-NN | pct=5%] Retrieval MAE: 143.2653 | R-squared: -1.6912 | Avg. Confidence: 1.0000
[Expert 3 | 5-NN | pct=5%] Retrieval MAE: 92.2224 | R-squared: -0.0437 | Avg. Confidence: 0.3203
[Expert 3 | 10-NN | pct=5%] Retrieval MAE: 94.3182 | R-squared: -0.1121 | Avg. Confidence: 0.1805
[Expert 3 | 20-NN | pct=5%] Retrieval MAE: 96.8677 | R-squared: -0.1827 | Avg. Confidence: 0.0953

  - Candidate pool sampling: 20%
  - Candidate pool size: 1165 / 5825
[Expert 3 | 1-NN | pct=20%] Retrieval MAE: 186.0746 | R-squared: -15.5051 | Avg. Confidence: 1.0000
[Expert 3 | 5-NN | pct=20%] Retrieval MAE: 90.8440 | R-squared: -0.0302 | Avg. Confidence: 0.3371
[Expert 3 | 10-NN | pct=20%] Retrieval MAE: 92.6671 | R-squared: -0.0784 | Avg. Confidence: 0.1933
[Expert 3 | 20-NN | pct=20%] Retrieval MAE: 95.1411 | R-squared: -0.1513 | Avg. Confidence: 0.1021

  - Candidate pool sampling: 100%
[Expert 3 | 1-NN | pct=100%] Retrieval MAE: 157.5824 | R-squared: -6.9849 | Avg. Confidence: 1.0000
[Expert 3 | 5-NN | pct=100%] Retrieval MAE: 85.7631 | R-squared: 0.0308 | Avg. Confidence: 0.3277
[Expert 3 | 10-NN | pct=100%] Retrieval MAE: 85.3883 | R-squared: 0.0171 | Avg. Confidence: 0.1936
[Expert 3 | 20-NN | pct=100%] Retrieval MAE: 88.5800 | R-squared: -0.0218 | Avg. Confidence: 0.1021
  - [Expert 3] RF (regression, 80/20): MAE=87.9901 | RMSE=91.9543 | R2=0.0464 (cases=827 | samples=1165)

--- Running PCA-kNN Baseline Comparison ---

üî¨ Starting PCA + k-NN Baseline Evaluation...
  - Applying PCA to 5825 embeddings...
  - Reduced dimension from 256 to 128
  - Applying PCA to 5825 embeddings...
  - Reduced dimension from 256 to 128

--- Evaluating PCA-kNN task: classification ---
[1-NN] PCA-kNN Accuracy: 0.8000 (on 200 queries)
[5-NN] PCA-kNN Accuracy: 0.7950 (on 200 queries)
[10-NN] PCA-kNN Accuracy: 0.7750 (on 200 queries)
[20-NN] PCA-kNN Accuracy: 0.7450 (on 200 queries)

--- Evaluating PCA-kNN task: regression ---
[1-NN] PCA-kNN MAE: 153.5655 | R-squared: -11.2873
[5-NN] PCA-kNN MAE: 64.9900 | R-squared: 0.2062
[10-NN] PCA-kNN MAE: 69.2389 | R-squared: 0.0601
[20-NN] PCA-kNN MAE: 71.5718 | R-squared: -0.0032


# Traditional

Warning: some classes have < 2 samples; disabling stratified split.
Log path: ../tests/input_data/receipt.xes
Activity key: concept:name
Activities: 27
Paths: 99
Samples (prefixes): 7143
Feature dimension: 129
Target classes: 27
Train size: 5714
Test size: 1429
Training sample %: 5
Train size (sampled): 286
RF test accuracy: 0.8034
RF intra_centroid_cos (mean): 0.7197
RF inter_centroid_cos (mean): 0.3855
RF centroid_margin (mean): 0.0468
RF knn_purity@5 (mean): 0.4056
RF knn_purity@10 (mean): 0.3900
PCA+kNN (k=1) test accuracy: 0.4003 (components: 3)
PCA intra_centroid_cos (mean): 0.7197
PCA inter_centroid_cos (mean): 0.3855
PCA centroid_margin (mean): 0.0468
PCA knn_purity@5 (mean): 0.3796
PCA knn_purity@10 (mean): 0.3748
Training sample %: 20
Train size (sampled): 1143
RF test accuracy: 0.8006
RF intra_centroid_cos (mean): 0.7197
RF inter_centroid_cos (mean): 0.3855
RF centroid_margin (mean): 0.0468
RF knn_purity@5 (mean): 0.4056
RF knn_purity@10 (mean): 0.3900
PCA+kNN (k=1) test accuracy: 0.4367 (components: 3)
PCA intra_centroid_cos (mean): 0.7197
PCA inter_centroid_cos (mean): 0.3855
PCA centroid_margin (mean): 0.0468
PCA knn_purity@5 (mean): 0.3796
PCA knn_purity@10 (mean): 0.3748
Training sample %: 100
Train size (sampled): 5714
RF test accuracy: 0.8146
RF intra_centroid_cos (mean): 0.7197
RF inter_centroid_cos (mean): 0.3855
RF centroid_margin (mean): 0.0468
RF knn_purity@5 (mean): 0.4056
RF knn_purity@10 (mean): 0.3900
PCA+kNN (k=1) test accuracy: 0.4290 (components: 3)
PCA intra_centroid_cos (mean): 0.7197
PCA inter_centroid_cos (mean): 0.3855
PCA centroid_margin (mean): 0.0468
PCA knn_purity@5 (mean): 0.3796
PCA knn_purity@10 (mean): 0.3748

Log path: ../tests/input_data/receipt.xes
Activity key: concept:name
Timestamp key: time:timestamp
Activities: 27
Paths: 99
Samples (prefixes): 7143
Feature dimension: 129
Train size: 5714
Test size: 1429
Training sample %: 5
Train size (sampled): 286
Per-case MAE (hours): 145.5825
Per-case RMSE (hours): 161.7793
R2: -1.1393
PCA+kNN (k=1) MAE (hours): 178.4433 RMSE (hours): 208.3259 R2: -5.6388 (components: 3)
Training sample %: 20
Train size (sampled): 1143
Per-case MAE (hours): 108.4645
Per-case RMSE (hours): 118.4349
R2: -0.0319
PCA+kNN (k=1) MAE (hours): 118.7252 RMSE (hours): 132.4514 R2: -0.4501 (components: 3)
Training sample %: 100
Train size (sampled): 5714
Per-case MAE (hours): 114.0330
Per-case RMSE (hours): 124.0873
R2: -0.0918
PCA+kNN (k=1) MAE (hours): 127.6530 RMSE (hours): 140.2912 R2: -0.4749 (components: 3)




!# ROADTRAFFIC EVENT LOG

# Foundation Model

--- üöÄ Initializing Test Run with Configuration ---
Loading training config from ./checkpoints/training_config.pth to match model...
  - Test Log: Found direct path: logs/roadtraffic_10000.xes.gz
  - Test Mode: retrieval_augmented
  - Test Episodes: 200
  - Checkpoint Directory: ./checkpoints
  - Checkpoint Epoch: Latest
  - Retrieval K-values: [1, 5, 10, 20]
  - Retrieval Candidate %: [5, 20, 100]
--- Running Testing Script in Stand-Alone Mode (strategy: 'learned') ---
Using device: cuda

üì¶ Loading test data...
Data loader initialized with strategy: 'learned'
‚úÖ Training artifacts loaded successfully from ./checkpoints/training_artifacts.pth
Transforming log: 'roadtraffic_10000' from /home/berti/events-transf/logs/roadtraffic_10000.xes.gz

Transforming logs: ['roadtraffic_10000']
‚úÖ Transformation complete.
‚úÖ Initialized MoEModel with 4 expert(s).
Character vocabulary set in LearnedEventEmbedder.
Character vocabulary set in LearnedEventEmbedder.
Character vocabulary set in LearnedEventEmbedder.
Character vocabulary set in LearnedEventEmbedder.
üîç Found latest checkpoint: model_epoch_10.pth
üíæ Loading weights from ./checkpoints/model_epoch_10.pth...

üõ†Ô∏è Creating test tasks...

--- Running in Retrieval-Augmented Evaluation Mode ---

üî¨ Starting Retrieval-Augmented Evaluation...
  - (MoE) Running k-NN eval for all 4 experts.
  - [Expert 0] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 0] Case ID stats: unique_cases=5542, total_tasks=17251
  - [Expert 0] Top case_id counts: [(np.str_('V18883'), 9), (np.str_('N83048'), 8), (np.str_('S66168'), 8), (np.str_('V16732'), 8), (np.str_('V16089'), 8)]
  - [Expert 0] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.9088 | inter_centroid_cos=0.2075 | centroid_margin=0.0467 | knn_purity@5=0.8124 knn_purity@10=0.8150
  - [Expert 0] Pre-computed 17251 embeddings for classification.
  - [Expert 0] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 0] Case ID stats: unique_cases=5542, total_tasks=17251
  - [Expert 0] Top case_id counts: [(np.str_('V18883'), 9), (np.str_('N83048'), 8), (np.str_('S66168'), 8), (np.str_('V16732'), 8), (np.str_('V16089'), 8)]
  - [Expert 0] Pre-computed 17251 embeddings for regression.
  - [Expert 1] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 1] Case ID stats: unique_cases=5542, total_tasks=17251
  - [Expert 1] Top case_id counts: [(np.str_('V18883'), 9), (np.str_('N83048'), 8), (np.str_('S66168'), 8), (np.str_('V16732'), 8), (np.str_('V16089'), 8)]
  - [Expert 1] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.9095 | inter_centroid_cos=0.1787 | centroid_margin=0.1039 | knn_purity@5=0.8130 knn_purity@10=0.8160
  - [Expert 1] Pre-computed 17251 embeddings for classification.
  - [Expert 1] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 1] Case ID stats: unique_cases=5542, total_tasks=17251
  - [Expert 1] Top case_id counts: [(np.str_('V18883'), 9), (np.str_('N83048'), 8), (np.str_('S66168'), 8), (np.str_('V16732'), 8), (np.str_('V16089'), 8)]
  - [Expert 1] Pre-computed 17251 embeddings for regression.
  - [Expert 2] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 2] Case ID stats: unique_cases=5542, total_tasks=17251
  - [Expert 2] Top case_id counts: [(np.str_('V18883'), 9), (np.str_('N83048'), 8), (np.str_('S66168'), 8), (np.str_('V16732'), 8), (np.str_('V16089'), 8)]
  - [Expert 2] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.9259 | inter_centroid_cos=0.2953 | centroid_margin=0.0774 | knn_purity@5=0.7984 knn_purity@10=0.8028
  - [Expert 2] Pre-computed 17251 embeddings for classification.
  - [Expert 2] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 2] Case ID stats: unique_cases=5542, total_tasks=17251
  - [Expert 2] Top case_id counts: [(np.str_('V18883'), 9), (np.str_('N83048'), 8), (np.str_('S66168'), 8), (np.str_('V16732'), 8), (np.str_('V16089'), 8)]
  - [Expert 2] Pre-computed 17251 embeddings for regression.
  - [Expert 3] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 3] Case ID stats: unique_cases=5542, total_tasks=17251
  - [Expert 3] Top case_id counts: [(np.str_('V18883'), 9), (np.str_('N83048'), 8), (np.str_('S66168'), 8), (np.str_('V16732'), 8), (np.str_('V16089'), 8)]
  - [Expert 3] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.8991 | inter_centroid_cos=0.2697 | centroid_margin=0.2138 | knn_purity@5=0.8056 knn_purity@10=0.8053
  - [Expert 3] Pre-computed 17251 embeddings for classification.
  - [Expert 3] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 3] Case ID stats: unique_cases=5542, total_tasks=17251
  - [Expert 3] Top case_id counts: [(np.str_('V18883'), 9), (np.str_('N83048'), 8), (np.str_('S66168'), 8), (np.str_('V16732'), 8), (np.str_('V16089'), 8)]
  - [Expert 3] Pre-computed 17251 embeddings for regression.
  - Inter-expert metrics (classification) Expert 0 vs Expert 1: mean_cos=-0.0409 | mean_l2=1.4427 | centroid_cos_mean=-0.0414
  - Inter-expert metrics (classification) Expert 0 vs Expert 2: mean_cos=0.0770 | mean_l2=1.3586 | centroid_cos_mean=0.0859
  - Inter-expert metrics (classification) Expert 0 vs Expert 3: mean_cos=0.1351 | mean_l2=1.3151 | centroid_cos_mean=0.1048
  - Inter-expert metrics (classification) Expert 1 vs Expert 2: mean_cos=-0.0271 | mean_l2=1.4328 | centroid_cos_mean=-0.0399
  - Inter-expert metrics (classification) Expert 1 vs Expert 3: mean_cos=-0.0177 | mean_l2=1.4263 | centroid_cos_mean=-0.0006
  - Inter-expert metrics (classification) Expert 2 vs Expert 3: mean_cos=0.0454 | mean_l2=1.3817 | centroid_cos_mean=0.0507
  - Inter-expert metrics (regression) Expert 0 vs Expert 1: mean_cos=-0.0409 | mean_l2=1.4427
  - Inter-expert metrics (regression) Expert 0 vs Expert 2: mean_cos=0.0770 | mean_l2=1.3586
  - Inter-expert metrics (regression) Expert 0 vs Expert 3: mean_cos=0.1351 | mean_l2=1.3151
  - Inter-expert metrics (regression) Expert 1 vs Expert 2: mean_cos=-0.0271 | mean_l2=1.4328
  - Inter-expert metrics (regression) Expert 1 vs Expert 3: mean_cos=-0.0177 | mean_l2=1.4263
  - Inter-expert metrics (regression) Expert 2 vs Expert 3: mean_cos=0.0454 | mean_l2=1.3817

--- Evaluating task: classification | Expert 0 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 863 / 17251
[Expert 0 | 1-NN | pct=5%] Retrieval Accuracy: 0.8450 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 0 | 5-NN | pct=5%] Retrieval Accuracy: 0.8600 | Avg. Confidence: 0.8555 (on 200 queries)
[Expert 0 | 10-NN | pct=5%] Retrieval Accuracy: 0.8600 | Avg. Confidence: 0.7623 (on 200 queries)
[Expert 0 | 20-NN | pct=5%] Retrieval Accuracy: 0.8250 | Avg. Confidence: 0.6335 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 3451 / 17251
[Expert 0 | 1-NN | pct=20%] Retrieval Accuracy: 0.8400 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 0 | 5-NN | pct=20%] Retrieval Accuracy: 0.8350 | Avg. Confidence: 0.8192 (on 200 queries)
[Expert 0 | 10-NN | pct=20%] Retrieval Accuracy: 0.8350 | Avg. Confidence: 0.7225 (on 200 queries)
[Expert 0 | 20-NN | pct=20%] Retrieval Accuracy: 0.8200 | Avg. Confidence: 0.6155 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 0 | 1-NN | pct=100%] Retrieval Accuracy: 0.8550 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 0 | 5-NN | pct=100%] Retrieval Accuracy: 0.8400 | Avg. Confidence: 0.8225 (on 200 queries)
[Expert 0 | 10-NN | pct=100%] Retrieval Accuracy: 0.8050 | Avg. Confidence: 0.7325 (on 200 queries)
[Expert 0 | 20-NN | pct=100%] Retrieval Accuracy: 0.7500 | Avg. Confidence: 0.6367 (on 200 queries)
  - [Expert 0] RF (classification, 80/20): Accuracy=0.8386 (n=3451)

--- Evaluating task: classification | Expert 1 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 863 / 17251
[Expert 1 | 1-NN | pct=5%] Retrieval Accuracy: 0.8550 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 1 | 5-NN | pct=5%] Retrieval Accuracy: 0.8650 | Avg. Confidence: 0.8480 (on 200 queries)
[Expert 1 | 10-NN | pct=5%] Retrieval Accuracy: 0.8600 | Avg. Confidence: 0.7487 (on 200 queries)
[Expert 1 | 20-NN | pct=5%] Retrieval Accuracy: 0.8400 | Avg. Confidence: 0.6189 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 3451 / 17251
[Expert 1 | 1-NN | pct=20%] Retrieval Accuracy: 0.8300 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 1 | 5-NN | pct=20%] Retrieval Accuracy: 0.8650 | Avg. Confidence: 0.8167 (on 200 queries)
[Expert 1 | 10-NN | pct=20%] Retrieval Accuracy: 0.8150 | Avg. Confidence: 0.7288 (on 200 queries)
[Expert 1 | 20-NN | pct=20%] Retrieval Accuracy: 0.8100 | Avg. Confidence: 0.6205 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 1 | 1-NN | pct=100%] Retrieval Accuracy: 0.8550 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 1 | 5-NN | pct=100%] Retrieval Accuracy: 0.8250 | Avg. Confidence: 0.8317 (on 200 queries)
[Expert 1 | 10-NN | pct=100%] Retrieval Accuracy: 0.8150 | Avg. Confidence: 0.7300 (on 200 queries)
[Expert 1 | 20-NN | pct=100%] Retrieval Accuracy: 0.8150 | Avg. Confidence: 0.6429 (on 200 queries)
  - [Expert 1] RF (classification, 80/20): Accuracy=0.8403 (n=3451)

--- Evaluating task: classification | Expert 2 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 863 / 17251
[Expert 2 | 1-NN | pct=5%] Retrieval Accuracy: 0.8500 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 2 | 5-NN | pct=5%] Retrieval Accuracy: 0.8550 | Avg. Confidence: 0.8478 (on 200 queries)
[Expert 2 | 10-NN | pct=5%] Retrieval Accuracy: 0.8650 | Avg. Confidence: 0.7696 (on 200 queries)
[Expert 2 | 20-NN | pct=5%] Retrieval Accuracy: 0.8200 | Avg. Confidence: 0.6243 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 3451 / 17251
[Expert 2 | 1-NN | pct=20%] Retrieval Accuracy: 0.8300 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 2 | 5-NN | pct=20%] Retrieval Accuracy: 0.8450 | Avg. Confidence: 0.8309 (on 200 queries)
[Expert 2 | 10-NN | pct=20%] Retrieval Accuracy: 0.8200 | Avg. Confidence: 0.7217 (on 200 queries)
[Expert 2 | 20-NN | pct=20%] Retrieval Accuracy: 0.7900 | Avg. Confidence: 0.6271 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 2 | 1-NN | pct=100%] Retrieval Accuracy: 0.8550 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 2 | 5-NN | pct=100%] Retrieval Accuracy: 0.8200 | Avg. Confidence: 0.8192 (on 200 queries)
[Expert 2 | 10-NN | pct=100%] Retrieval Accuracy: 0.8100 | Avg. Confidence: 0.7167 (on 200 queries)
[Expert 2 | 20-NN | pct=100%] Retrieval Accuracy: 0.7700 | Avg. Confidence: 0.6250 (on 200 queries)
  - [Expert 2] RF (classification, 80/20): Accuracy=0.8377 (n=3451)

--- Evaluating task: classification | Expert 3 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 863 / 17251
[Expert 3 | 1-NN | pct=5%] Retrieval Accuracy: 0.8550 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 3 | 5-NN | pct=5%] Retrieval Accuracy: 0.8550 | Avg. Confidence: 0.8536 (on 200 queries)
[Expert 3 | 10-NN | pct=5%] Retrieval Accuracy: 0.8650 | Avg. Confidence: 0.7460 (on 200 queries)
[Expert 3 | 20-NN | pct=5%] Retrieval Accuracy: 0.8400 | Avg. Confidence: 0.6225 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 3451 / 17251
[Expert 3 | 1-NN | pct=20%] Retrieval Accuracy: 0.8350 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 3 | 5-NN | pct=20%] Retrieval Accuracy: 0.8350 | Avg. Confidence: 0.8217 (on 200 queries)
[Expert 3 | 10-NN | pct=20%] Retrieval Accuracy: 0.8200 | Avg. Confidence: 0.7254 (on 200 queries)
[Expert 3 | 20-NN | pct=20%] Retrieval Accuracy: 0.8050 | Avg. Confidence: 0.6251 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 3 | 1-NN | pct=100%] Retrieval Accuracy: 0.8400 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 3 | 5-NN | pct=100%] Retrieval Accuracy: 0.8000 | Avg. Confidence: 0.8317 (on 200 queries)
[Expert 3 | 10-NN | pct=100%] Retrieval Accuracy: 0.7700 | Avg. Confidence: 0.7358 (on 200 queries)
[Expert 3 | 20-NN | pct=100%] Retrieval Accuracy: 0.7650 | Avg. Confidence: 0.6438 (on 200 queries)
  - [Expert 3] RF (classification, 80/20): Accuracy=0.8374 (n=3451)

--- Evaluating task: regression | Expert 0 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 863 / 17251
[Expert 0 | 1-NN | pct=5%] Retrieval MAE: 6668.7706 | R-squared: -0.9287 | Avg. Confidence: 1.0000
[Expert 0 | 5-NN | pct=5%] Retrieval MAE: 5808.2174 | R-squared: -0.3119 | Avg. Confidence: 0.2994
[Expert 0 | 10-NN | pct=5%] Retrieval MAE: 5550.1233 | R-squared: -0.1964 | Avg. Confidence: 0.1815
[Expert 0 | 20-NN | pct=5%] Retrieval MAE: 5491.3101 | R-squared: -0.1577 | Avg. Confidence: 0.1048

  - Candidate pool sampling: 20%
  - Candidate pool size: 3451 / 17251
[Expert 0 | 1-NN | pct=20%] Retrieval MAE: 6440.4659 | R-squared: -0.6957 | Avg. Confidence: 1.0000
[Expert 0 | 5-NN | pct=20%] Retrieval MAE: 5523.1406 | R-squared: -0.1368 | Avg. Confidence: 0.2722
[Expert 0 | 10-NN | pct=20%] Retrieval MAE: 5323.1267 | R-squared: -0.0746 | Avg. Confidence: 0.1622
[Expert 0 | 20-NN | pct=20%] Retrieval MAE: 5097.2208 | R-squared: -0.0128 | Avg. Confidence: 0.0882

  - Candidate pool sampling: 100%
[Expert 0 | 1-NN | pct=100%] Retrieval MAE: 6481.7055 | R-squared: -0.6922 | Avg. Confidence: 1.0000
[Expert 0 | 5-NN | pct=100%] Retrieval MAE: 5604.1546 | R-squared: -0.2109 | Avg. Confidence: 0.2347
[Expert 0 | 10-NN | pct=100%] Retrieval MAE: 5247.7048 | R-squared: -0.0604 | Avg. Confidence: 0.1316
[Expert 0 | 20-NN | pct=100%] Retrieval MAE: 5347.3821 | R-squared: -0.0710 | Avg. Confidence: 0.0738
  - [Expert 0] RF (regression, 80/20): MAE=5267.0035 | RMSE=5349.1250 | R2=-0.1959 (cases=2741 | samples=3451)

--- Evaluating task: regression | Expert 1 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 863 / 17251
[Expert 1 | 1-NN | pct=5%] Retrieval MAE: 6623.5005 | R-squared: -0.8717 | Avg. Confidence: 1.0000
[Expert 1 | 5-NN | pct=5%] Retrieval MAE: 5789.3340 | R-squared: -0.3214 | Avg. Confidence: 0.3007
[Expert 1 | 10-NN | pct=5%] Retrieval MAE: 5591.5754 | R-squared: -0.2070 | Avg. Confidence: 0.1794
[Expert 1 | 20-NN | pct=5%] Retrieval MAE: 5473.5758 | R-squared: -0.1471 | Avg. Confidence: 0.1026

  - Candidate pool sampling: 20%
  - Candidate pool size: 3451 / 17251
[Expert 1 | 1-NN | pct=20%] Retrieval MAE: 6466.7157 | R-squared: -0.5902 | Avg. Confidence: 1.0000
[Expert 1 | 5-NN | pct=20%] Retrieval MAE: 5502.7497 | R-squared: -0.1285 | Avg. Confidence: 0.2759
[Expert 1 | 10-NN | pct=20%] Retrieval MAE: 5375.8736 | R-squared: -0.0812 | Avg. Confidence: 0.1640
[Expert 1 | 20-NN | pct=20%] Retrieval MAE: 5124.7411 | R-squared: -0.0153 | Avg. Confidence: 0.0882

  - Candidate pool sampling: 100%
[Expert 1 | 1-NN | pct=100%] Retrieval MAE: 6294.2452 | R-squared: -0.5169 | Avg. Confidence: 1.0000
[Expert 1 | 5-NN | pct=100%] Retrieval MAE: 5499.8553 | R-squared: -0.1651 | Avg. Confidence: 0.2357
[Expert 1 | 10-NN | pct=100%] Retrieval MAE: 5364.5891 | R-squared: -0.0787 | Avg. Confidence: 0.1338
[Expert 1 | 20-NN | pct=100%] Retrieval MAE: 5315.5596 | R-squared: -0.0491 | Avg. Confidence: 0.0754
  - [Expert 1] RF (regression, 80/20): MAE=5270.4034 | RMSE=5352.3349 | R2=-0.1999 (cases=2741 | samples=3451)

--- Evaluating task: regression | Expert 2 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 863 / 17251
[Expert 2 | 1-NN | pct=5%] Retrieval MAE: 6816.7503 | R-squared: -0.9895 | Avg. Confidence: 1.0000
[Expert 2 | 5-NN | pct=5%] Retrieval MAE: 5642.5238 | R-squared: -0.2521 | Avg. Confidence: 0.3006
[Expert 2 | 10-NN | pct=5%] Retrieval MAE: 5530.0532 | R-squared: -0.1996 | Avg. Confidence: 0.1803
[Expert 2 | 20-NN | pct=5%] Retrieval MAE: 5423.6313 | R-squared: -0.1361 | Avg. Confidence: 0.1012

  - Candidate pool sampling: 20%
  - Candidate pool size: 3451 / 17251
[Expert 2 | 1-NN | pct=20%] Retrieval MAE: 6180.2955 | R-squared: -0.7116 | Avg. Confidence: 1.0000
[Expert 2 | 5-NN | pct=20%] Retrieval MAE: 5432.5804 | R-squared: -0.1096 | Avg. Confidence: 0.2850
[Expert 2 | 10-NN | pct=20%] Retrieval MAE: 5220.5753 | R-squared: -0.0406 | Avg. Confidence: 0.1686
[Expert 2 | 20-NN | pct=20%] Retrieval MAE: 5118.6213 | R-squared: -0.0213 | Avg. Confidence: 0.0898

  - Candidate pool sampling: 100%
[Expert 2 | 1-NN | pct=100%] Retrieval MAE: 6096.8552 | R-squared: -0.5698 | Avg. Confidence: 1.0000
[Expert 2 | 5-NN | pct=100%] Retrieval MAE: 5554.7064 | R-squared: -0.1697 | Avg. Confidence: 0.2417
[Expert 2 | 10-NN | pct=100%] Retrieval MAE: 5245.7289 | R-squared: -0.0744 | Avg. Confidence: 0.1387
[Expert 2 | 20-NN | pct=100%] Retrieval MAE: 5282.9811 | R-squared: -0.0615 | Avg. Confidence: 0.0787
  - [Expert 2] RF (regression, 80/20): MAE=5269.6080 | RMSE=5352.1847 | R2=-0.2004 (cases=2741 | samples=3451)

--- Evaluating task: regression | Expert 3 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 863 / 17251
[Expert 3 | 1-NN | pct=5%] Retrieval MAE: 6320.8602 | R-squared: -0.7677 | Avg. Confidence: 1.0000
[Expert 3 | 5-NN | pct=5%] Retrieval MAE: 5768.1600 | R-squared: -0.2930 | Avg. Confidence: 0.2987
[Expert 3 | 10-NN | pct=5%] Retrieval MAE: 5604.4986 | R-squared: -0.2134 | Avg. Confidence: 0.1796
[Expert 3 | 20-NN | pct=5%] Retrieval MAE: 5539.7993 | R-squared: -0.1680 | Avg. Confidence: 0.1025

  - Candidate pool sampling: 20%
  - Candidate pool size: 3451 / 17251
[Expert 3 | 1-NN | pct=20%] Retrieval MAE: 6207.8302 | R-squared: -0.5815 | Avg. Confidence: 1.0000
[Expert 3 | 5-NN | pct=20%] Retrieval MAE: 5582.9753 | R-squared: -0.1934 | Avg. Confidence: 0.2712
[Expert 3 | 10-NN | pct=20%] Retrieval MAE: 5400.4524 | R-squared: -0.0930 | Avg. Confidence: 0.1613
[Expert 3 | 20-NN | pct=20%] Retrieval MAE: 5162.4214 | R-squared: -0.0221 | Avg. Confidence: 0.0870

  - Candidate pool sampling: 100%
[Expert 3 | 1-NN | pct=100%] Retrieval MAE: 6443.5153 | R-squared: -0.6051 | Avg. Confidence: 1.0000
[Expert 3 | 5-NN | pct=100%] Retrieval MAE: 5534.7576 | R-squared: -0.2050 | Avg. Confidence: 0.2360
[Expert 3 | 10-NN | pct=100%] Retrieval MAE: 5340.9785 | R-squared: -0.0804 | Avg. Confidence: 0.1332
[Expert 3 | 20-NN | pct=100%] Retrieval MAE: 5268.8377 | R-squared: -0.0601 | Avg. Confidence: 0.0743
  - [Expert 3] RF (regression, 80/20): MAE=5271.8538 | RMSE=5353.6374 | R2=-0.1927 (cases=2741 | samples=3451)

--- Running PCA-kNN Baseline Comparison ---

üî¨ Starting PCA + k-NN Baseline Evaluation...
  - Applying PCA to 17251 embeddings...
  - Reduced dimension from 256 to 128
  - Applying PCA to 17251 embeddings...
  - Reduced dimension from 256 to 128

--- Evaluating PCA-kNN task: classification ---
[1-NN] PCA-kNN Accuracy: 0.8600 (on 200 queries)
[5-NN] PCA-kNN Accuracy: 0.8950 (on 200 queries)
[10-NN] PCA-kNN Accuracy: 0.9050 (on 200 queries)
[20-NN] PCA-kNN Accuracy: 0.9100 (on 200 queries)

--- Evaluating PCA-kNN task: regression ---
[1-NN] PCA-kNN MAE: 6412.6950 | R-squared: -0.4840
[5-NN] PCA-kNN MAE: 5813.5401 | R-squared: -0.1740
[10-NN] PCA-kNN MAE: 5685.7264 | R-squared: -0.1442
[20-NN] PCA-kNN MAE: 5653.9271 | R-squared: -0.1253

# Traditional

Log path: ../tests/input_data/roadtraffic_10000.xes.gz
Activity key: concept:name
Activities: 11
Paths: 46
Samples (prefixes): 27253
Feature dimension: 60
Target classes: 11
Train size: 21802
Test size: 5451
Training sample %: 5
Train size (sampled): 1090
RF test accuracy: 0.9332
RF intra_centroid_cos (mean): 0.8631
RF inter_centroid_cos (mean): 0.3322
RF centroid_margin (mean): 0.2107
RF knn_purity@5 (mean): 0.8522
RF knn_purity@10 (mean): 0.8463
PCA+kNN (k=1) test accuracy: 0.8287 (components: 2)
PCA intra_centroid_cos (mean): 0.8653
PCA inter_centroid_cos (mean): 0.3562
PCA centroid_margin (mean): 0.1823
PCA knn_purity@5 (mean): 0.6680
PCA knn_purity@10 (mean): 0.6495
Training sample %: 20
Train size (sampled): 4360
RF test accuracy: 0.9404
RF intra_centroid_cos (mean): 0.8631
RF inter_centroid_cos (mean): 0.3322
RF centroid_margin (mean): 0.2107
RF knn_purity@5 (mean): 0.8522
RF knn_purity@10 (mean): 0.8463
PCA+kNN (k=1) test accuracy: 0.8376 (components: 2)
PCA intra_centroid_cos (mean): 0.8653
PCA inter_centroid_cos (mean): 0.3564
PCA centroid_margin (mean): 0.1822
PCA knn_purity@5 (mean): 0.6580
PCA knn_purity@10 (mean): 0.6451
Training sample %: 100
Train size (sampled): 21802
RF test accuracy: 0.9501
RF intra_centroid_cos (mean): 0.8631
RF inter_centroid_cos (mean): 0.3322
RF centroid_margin (mean): 0.2107
RF knn_purity@5 (mean): 0.8522
RF knn_purity@10 (mean): 0.8463
PCA+kNN (k=1) test accuracy: 0.8373 (components: 2)
PCA intra_centroid_cos (mean): 0.8653
PCA inter_centroid_cos (mean): 0.3561
PCA centroid_margin (mean): 0.1820
PCA knn_purity@5 (mean): 0.6704
PCA knn_purity@10 (mean): 0.6600

Log path: ../tests/input_data/roadtraffic_10000.xes.gz
Activity key: concept:name
Timestamp key: time:timestamp
Activities: 11
Paths: 46
Samples (prefixes): 27253
Feature dimension: 60
Train size: 21802
Test size: 5451
Training sample %: 5
Train size (sampled): 1090
Per-case MAE (hours): 4308.5511
Per-case RMSE (hours): 4520.8946
R2: 0.2160
PCA+kNN (k=1) MAE (hours): 5521.6784 RMSE (hours): 5824.9054 R2: -0.3120 (components: 2)
Training sample %: 20
Train size (sampled): 4360
Per-case MAE (hours): 4215.8826
Per-case RMSE (hours): 4423.9195
R2: 0.2497
PCA+kNN (k=1) MAE (hours): 5401.2368 RMSE (hours): 5717.9793 R2: -0.2831 (components: 2)
Training sample %: 100
Train size (sampled): 21802
Per-case MAE (hours): 4040.7257
Per-case RMSE (hours): 4234.6467
R2: 0.3103
PCA+kNN (k=1) MAE (hours): 5109.5142 RMSE (hours): 5424.9015 R2: -0.2792 (components: 2)


!# SEPSIS EVENT LOG

# Foundation Model

--- üöÄ Initializing Test Run with Configuration ---
Loading training config from ./checkpoints/training_config.pth to match model...
  - Test Log: Found direct path: logs/sepsis.xes
  - Test Mode: retrieval_augmented
  - Test Episodes: 200
  - Checkpoint Directory: ./checkpoints
  - Checkpoint Epoch: Latest
  - Retrieval K-values: [1, 5, 10, 20]
  - Retrieval Candidate %: [5, 20, 100]
--- Running Testing Script in Stand-Alone Mode (strategy: 'learned') ---
Using device: cuda

üì¶ Loading test data...
Data loader initialized with strategy: 'learned'
‚úÖ Training artifacts loaded successfully from ./checkpoints/training_artifacts.pth
Transforming log: 'sepsis' from /home/berti/events-transf/logs/sepsis.xes

Transforming logs: ['sepsis']
‚úÖ Transformation complete.
‚úÖ Initialized MoEModel with 4 expert(s).
Character vocabulary set in LearnedEventEmbedder.
Character vocabulary set in LearnedEventEmbedder.
Character vocabulary set in LearnedEventEmbedder.
Character vocabulary set in LearnedEventEmbedder.
üîç Found latest checkpoint: model_epoch_10.pth
üíæ Loading weights from ./checkpoints/model_epoch_10.pth...

üõ†Ô∏è Creating test tasks...

--- Running in Retrieval-Augmented Evaluation Mode ---

üî¨ Starting Retrieval-Augmented Evaluation...
  - (MoE) Running k-NN eval for all 4 experts.
  - [Expert 0] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 0] Case ID stats: unique_cases=1050, total_tasks=13114
  - [Expert 0] Top case_id counts: [(np.str_('NGA'), 183), (np.str_('KM'), 168), (np.str_('OD'), 116), (np.str_('GK'), 86), (np.str_('YX'), 82)]
  - [Expert 0] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.4252 | inter_centroid_cos=-0.0115 | centroid_margin=0.0788 | knn_purity@5=0.4988 knn_purity@10=0.4826
  - [Expert 0] Pre-computed 13114 embeddings for classification.
  - [Expert 0] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 0] Case ID stats: unique_cases=1050, total_tasks=13114
  - [Expert 0] Top case_id counts: [(np.str_('NGA'), 183), (np.str_('KM'), 168), (np.str_('OD'), 116), (np.str_('GK'), 86), (np.str_('YX'), 82)]
  - [Expert 0] Pre-computed 13114 embeddings for regression.
  - [Expert 1] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 1] Case ID stats: unique_cases=1050, total_tasks=13114
  - [Expert 1] Top case_id counts: [(np.str_('NGA'), 183), (np.str_('KM'), 168), (np.str_('OD'), 116), (np.str_('GK'), 86), (np.str_('YX'), 82)]
  - [Expert 1] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.4076 | inter_centroid_cos=-0.0119 | centroid_margin=0.1164 | knn_purity@5=0.5062 knn_purity@10=0.4973
  - [Expert 1] Pre-computed 13114 embeddings for classification.
  - [Expert 1] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 1] Case ID stats: unique_cases=1050, total_tasks=13114
  - [Expert 1] Top case_id counts: [(np.str_('NGA'), 183), (np.str_('KM'), 168), (np.str_('OD'), 116), (np.str_('GK'), 86), (np.str_('YX'), 82)]
  - [Expert 1] Pre-computed 13114 embeddings for regression.
  - [Expert 2] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 2] Case ID stats: unique_cases=1050, total_tasks=13114
  - [Expert 2] Top case_id counts: [(np.str_('NGA'), 183), (np.str_('KM'), 168), (np.str_('OD'), 116), (np.str_('GK'), 86), (np.str_('YX'), 82)]
  - [Expert 2] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.4524 | inter_centroid_cos=0.0247 | centroid_margin=0.0878 | knn_purity@5=0.5252 knn_purity@10=0.5168
  - [Expert 2] Pre-computed 13114 embeddings for classification.
  - [Expert 2] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 2] Case ID stats: unique_cases=1050, total_tasks=13114
  - [Expert 2] Top case_id counts: [(np.str_('NGA'), 183), (np.str_('KM'), 168), (np.str_('OD'), 116), (np.str_('GK'), 86), (np.str_('YX'), 82)]
  - [Expert 2] Pre-computed 13114 embeddings for regression.
  - [Expert 3] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 3] Case ID stats: unique_cases=1050, total_tasks=13114
  - [Expert 3] Top case_id counts: [(np.str_('NGA'), 183), (np.str_('KM'), 168), (np.str_('OD'), 116), (np.str_('GK'), 86), (np.str_('YX'), 82)]
  - [Expert 3] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.4541 | inter_centroid_cos=0.0196 | centroid_margin=0.1250 | knn_purity@5=0.5242 knn_purity@10=0.5177
  - [Expert 3] Pre-computed 13114 embeddings for classification.
  - [Expert 3] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 3] Case ID stats: unique_cases=1050, total_tasks=13114
  - [Expert 3] Top case_id counts: [(np.str_('NGA'), 183), (np.str_('KM'), 168), (np.str_('OD'), 116), (np.str_('GK'), 86), (np.str_('YX'), 82)]
  - [Expert 3] Pre-computed 13114 embeddings for regression.
  - Inter-expert metrics (classification) Expert 0 vs Expert 1: mean_cos=-0.1046 | mean_l2=1.4863 | centroid_cos_mean=-0.1127
  - Inter-expert metrics (classification) Expert 0 vs Expert 2: mean_cos=0.0012 | mean_l2=1.4132 | centroid_cos_mean=0.0038
  - Inter-expert metrics (classification) Expert 0 vs Expert 3: mean_cos=0.0726 | mean_l2=1.3608 | centroid_cos_mean=0.0613
  - Inter-expert metrics (classification) Expert 1 vs Expert 2: mean_cos=0.0572 | mean_l2=1.3728 | centroid_cos_mean=0.0623
  - Inter-expert metrics (classification) Expert 1 vs Expert 3: mean_cos=-0.1145 | mean_l2=1.4923 | centroid_cos_mean=-0.1106
  - Inter-expert metrics (classification) Expert 2 vs Expert 3: mean_cos=0.0394 | mean_l2=1.3851 | centroid_cos_mean=0.0620
  - Inter-expert metrics (regression) Expert 0 vs Expert 1: mean_cos=-0.1046 | mean_l2=1.4863
  - Inter-expert metrics (regression) Expert 0 vs Expert 2: mean_cos=0.0012 | mean_l2=1.4132
  - Inter-expert metrics (regression) Expert 0 vs Expert 3: mean_cos=0.0726 | mean_l2=1.3608
  - Inter-expert metrics (regression) Expert 1 vs Expert 2: mean_cos=0.0572 | mean_l2=1.3728
  - Inter-expert metrics (regression) Expert 1 vs Expert 3: mean_cos=-0.1145 | mean_l2=1.4923
  - Inter-expert metrics (regression) Expert 2 vs Expert 3: mean_cos=0.0394 | mean_l2=1.3851

--- Evaluating task: classification | Expert 0 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 656 / 13114
[Expert 0 | 1-NN | pct=5%] Retrieval Accuracy: 0.4650 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 0 | 5-NN | pct=5%] Retrieval Accuracy: 0.4750 | Avg. Confidence: 0.4678 (on 200 queries)
[Expert 0 | 10-NN | pct=5%] Retrieval Accuracy: 0.4600 | Avg. Confidence: 0.3380 (on 200 queries)
[Expert 0 | 20-NN | pct=5%] Retrieval Accuracy: 0.4500 | Avg. Confidence: 0.2596 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 2623 / 13114
[Expert 0 | 1-NN | pct=20%] Retrieval Accuracy: 0.4400 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 0 | 5-NN | pct=20%] Retrieval Accuracy: 0.4400 | Avg. Confidence: 0.5079 (on 200 queries)
[Expert 0 | 10-NN | pct=20%] Retrieval Accuracy: 0.4650 | Avg. Confidence: 0.3987 (on 200 queries)
[Expert 0 | 20-NN | pct=20%] Retrieval Accuracy: 0.4700 | Avg. Confidence: 0.3087 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 0 | 1-NN | pct=100%] Retrieval Accuracy: 0.5300 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 0 | 5-NN | pct=100%] Retrieval Accuracy: 0.5700 | Avg. Confidence: 0.5340 (on 200 queries)
[Expert 0 | 10-NN | pct=100%] Retrieval Accuracy: 0.5200 | Avg. Confidence: 0.4237 (on 200 queries)
[Expert 0 | 20-NN | pct=100%] Retrieval Accuracy: 0.4850 | Avg. Confidence: 0.3617 (on 200 queries)
  - [Expert 0] RF (classification, 80/20): Accuracy=0.5608 (n=2623)

--- Evaluating task: classification | Expert 1 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 656 / 13114
[Expert 1 | 1-NN | pct=5%] Retrieval Accuracy: 0.4200 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 1 | 5-NN | pct=5%] Retrieval Accuracy: 0.4450 | Avg. Confidence: 0.4653 (on 200 queries)
[Expert 1 | 10-NN | pct=5%] Retrieval Accuracy: 0.4200 | Avg. Confidence: 0.3409 (on 200 queries)
[Expert 1 | 20-NN | pct=5%] Retrieval Accuracy: 0.4150 | Avg. Confidence: 0.2531 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 2623 / 13114
[Expert 1 | 1-NN | pct=20%] Retrieval Accuracy: 0.5150 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 1 | 5-NN | pct=20%] Retrieval Accuracy: 0.4800 | Avg. Confidence: 0.5011 (on 200 queries)
[Expert 1 | 10-NN | pct=20%] Retrieval Accuracy: 0.4750 | Avg. Confidence: 0.3864 (on 200 queries)
[Expert 1 | 20-NN | pct=20%] Retrieval Accuracy: 0.4800 | Avg. Confidence: 0.3160 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 1 | 1-NN | pct=100%] Retrieval Accuracy: 0.5650 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 1 | 5-NN | pct=100%] Retrieval Accuracy: 0.5550 | Avg. Confidence: 0.5566 (on 200 queries)
[Expert 1 | 10-NN | pct=100%] Retrieval Accuracy: 0.5050 | Avg. Confidence: 0.4403 (on 200 queries)
[Expert 1 | 20-NN | pct=100%] Retrieval Accuracy: 0.4650 | Avg. Confidence: 0.3653 (on 200 queries)
  - [Expert 1] RF (classification, 80/20): Accuracy=0.5505 (n=2623)

--- Evaluating task: classification | Expert 2 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 656 / 13114
[Expert 2 | 1-NN | pct=5%] Retrieval Accuracy: 0.4500 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 2 | 5-NN | pct=5%] Retrieval Accuracy: 0.4550 | Avg. Confidence: 0.4797 (on 200 queries)
[Expert 2 | 10-NN | pct=5%] Retrieval Accuracy: 0.4250 | Avg. Confidence: 0.3682 (on 200 queries)
[Expert 2 | 20-NN | pct=5%] Retrieval Accuracy: 0.3750 | Avg. Confidence: 0.2496 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 2623 / 13114
[Expert 2 | 1-NN | pct=20%] Retrieval Accuracy: 0.4700 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 2 | 5-NN | pct=20%] Retrieval Accuracy: 0.4700 | Avg. Confidence: 0.5050 (on 200 queries)
[Expert 2 | 10-NN | pct=20%] Retrieval Accuracy: 0.4800 | Avg. Confidence: 0.4006 (on 200 queries)
[Expert 2 | 20-NN | pct=20%] Retrieval Accuracy: 0.4900 | Avg. Confidence: 0.3149 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 2 | 1-NN | pct=100%] Retrieval Accuracy: 0.5450 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 2 | 5-NN | pct=100%] Retrieval Accuracy: 0.5350 | Avg. Confidence: 0.5472 (on 200 queries)
[Expert 2 | 10-NN | pct=100%] Retrieval Accuracy: 0.4850 | Avg. Confidence: 0.4224 (on 200 queries)
[Expert 2 | 20-NN | pct=100%] Retrieval Accuracy: 0.4600 | Avg. Confidence: 0.3532 (on 200 queries)
  - [Expert 2] RF (classification, 80/20): Accuracy=0.5715 (n=2623)

--- Evaluating task: classification | Expert 3 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 656 / 13114
[Expert 3 | 1-NN | pct=5%] Retrieval Accuracy: 0.4850 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 3 | 5-NN | pct=5%] Retrieval Accuracy: 0.4550 | Avg. Confidence: 0.4852 (on 200 queries)
[Expert 3 | 10-NN | pct=5%] Retrieval Accuracy: 0.4400 | Avg. Confidence: 0.3769 (on 200 queries)
[Expert 3 | 20-NN | pct=5%] Retrieval Accuracy: 0.4100 | Avg. Confidence: 0.2660 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 2623 / 13114
[Expert 3 | 1-NN | pct=20%] Retrieval Accuracy: 0.4900 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 3 | 5-NN | pct=20%] Retrieval Accuracy: 0.4800 | Avg. Confidence: 0.5256 (on 200 queries)
[Expert 3 | 10-NN | pct=20%] Retrieval Accuracy: 0.4700 | Avg. Confidence: 0.4291 (on 200 queries)
[Expert 3 | 20-NN | pct=20%] Retrieval Accuracy: 0.5000 | Avg. Confidence: 0.3428 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 3 | 1-NN | pct=100%] Retrieval Accuracy: 0.5300 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 3 | 5-NN | pct=100%] Retrieval Accuracy: 0.5450 | Avg. Confidence: 0.5554 (on 200 queries)
[Expert 3 | 10-NN | pct=100%] Retrieval Accuracy: 0.5150 | Avg. Confidence: 0.4376 (on 200 queries)
[Expert 3 | 20-NN | pct=100%] Retrieval Accuracy: 0.4650 | Avg. Confidence: 0.3663 (on 200 queries)
  - [Expert 3] RF (classification, 80/20): Accuracy=0.5734 (n=2623)

--- Evaluating task: regression | Expert 0 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 656 / 13114
[Expert 0 | 1-NN | pct=5%] Retrieval MAE: 1191.3179 | R-squared: -1.3009 | Avg. Confidence: 1.0000
[Expert 0 | 5-NN | pct=5%] Retrieval MAE: 785.6914 | R-squared: -0.2300 | Avg. Confidence: 0.3067
[Expert 0 | 10-NN | pct=5%] Retrieval MAE: 745.7401 | R-squared: -0.2134 | Avg. Confidence: 0.1829
[Expert 0 | 20-NN | pct=5%] Retrieval MAE: 735.4610 | R-squared: -0.2143 | Avg. Confidence: 0.0982

  - Candidate pool sampling: 20%
  - Candidate pool size: 2623 / 13114
[Expert 0 | 1-NN | pct=20%] Retrieval MAE: 1069.5300 | R-squared: -0.7701 | Avg. Confidence: 1.0000
[Expert 0 | 5-NN | pct=20%] Retrieval MAE: 787.1371 | R-squared: -0.1856 | Avg. Confidence: 0.3121
[Expert 0 | 10-NN | pct=20%] Retrieval MAE: 741.8382 | R-squared: -0.1704 | Avg. Confidence: 0.1841
[Expert 0 | 20-NN | pct=20%] Retrieval MAE: 737.0943 | R-squared: -0.1873 | Avg. Confidence: 0.0982

  - Candidate pool sampling: 100%
[Expert 0 | 1-NN | pct=100%] Retrieval MAE: 1077.2461 | R-squared: -0.8781 | Avg. Confidence: 1.0000
[Expert 0 | 5-NN | pct=100%] Retrieval MAE: 794.1894 | R-squared: -0.2149 | Avg. Confidence: 0.3070
[Expert 0 | 10-NN | pct=100%] Retrieval MAE: 753.1765 | R-squared: -0.1856 | Avg. Confidence: 0.1784
[Expert 0 | 20-NN | pct=100%] Retrieval MAE: 740.2142 | R-squared: -0.1813 | Avg. Confidence: 0.0975
  - [Expert 0] RF (regression, 80/20): MAE=700.1409 | RMSE=722.4697 | R2=-0.1461 (cases=882 | samples=2623)

--- Evaluating task: regression | Expert 1 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 656 / 13114
[Expert 1 | 1-NN | pct=5%] Retrieval MAE: 1163.5865 | R-squared: -1.1390 | Avg. Confidence: 1.0000
[Expert 1 | 5-NN | pct=5%] Retrieval MAE: 779.2564 | R-squared: -0.2119 | Avg. Confidence: 0.3093
[Expert 1 | 10-NN | pct=5%] Retrieval MAE: 751.5275 | R-squared: -0.2106 | Avg. Confidence: 0.1849
[Expert 1 | 20-NN | pct=5%] Retrieval MAE: 738.5369 | R-squared: -0.2145 | Avg. Confidence: 0.0987

  - Candidate pool sampling: 20%
  - Candidate pool size: 2623 / 13114
[Expert 1 | 1-NN | pct=20%] Retrieval MAE: 1259.3813 | R-squared: -1.4340 | Avg. Confidence: 1.0000
[Expert 1 | 5-NN | pct=20%] Retrieval MAE: 800.7144 | R-squared: -0.2253 | Avg. Confidence: 0.3052
[Expert 1 | 10-NN | pct=20%] Retrieval MAE: 759.2480 | R-squared: -0.1862 | Avg. Confidence: 0.1797
[Expert 1 | 20-NN | pct=20%] Retrieval MAE: 740.2075 | R-squared: -0.1861 | Avg. Confidence: 0.0969

  - Candidate pool sampling: 100%
[Expert 1 | 1-NN | pct=100%] Retrieval MAE: 1197.6209 | R-squared: -1.3314 | Avg. Confidence: 1.0000
[Expert 1 | 5-NN | pct=100%] Retrieval MAE: 797.5675 | R-squared: -0.2258 | Avg. Confidence: 0.2963
[Expert 1 | 10-NN | pct=100%] Retrieval MAE: 754.1763 | R-squared: -0.1910 | Avg. Confidence: 0.1718
[Expert 1 | 20-NN | pct=100%] Retrieval MAE: 737.3887 | R-squared: -0.1853 | Avg. Confidence: 0.0947
  - [Expert 1] RF (regression, 80/20): MAE=694.7247 | RMSE=717.0791 | R2=-0.1315 (cases=882 | samples=2623)

--- Evaluating task: regression | Expert 2 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 656 / 13114
[Expert 2 | 1-NN | pct=5%] Retrieval MAE: 1311.8223 | R-squared: -1.5418 | Avg. Confidence: 1.0000
[Expert 2 | 5-NN | pct=5%] Retrieval MAE: 811.3040 | R-squared: -0.2674 | Avg. Confidence: 0.3152
[Expert 2 | 10-NN | pct=5%] Retrieval MAE: 757.6472 | R-squared: -0.2286 | Avg. Confidence: 0.1885
[Expert 2 | 20-NN | pct=5%] Retrieval MAE: 736.7927 | R-squared: -0.2239 | Avg. Confidence: 0.1001

  - Candidate pool sampling: 20%
  - Candidate pool size: 2623 / 13114
[Expert 2 | 1-NN | pct=20%] Retrieval MAE: 1136.1457 | R-squared: -0.8203 | Avg. Confidence: 1.0000
[Expert 2 | 5-NN | pct=20%] Retrieval MAE: 783.9160 | R-squared: -0.1672 | Avg. Confidence: 0.3106
[Expert 2 | 10-NN | pct=20%] Retrieval MAE: 760.6752 | R-squared: -0.1875 | Avg. Confidence: 0.1845
[Expert 2 | 20-NN | pct=20%] Retrieval MAE: 737.7566 | R-squared: -0.1863 | Avg. Confidence: 0.0992

  - Candidate pool sampling: 100%
[Expert 2 | 1-NN | pct=100%] Retrieval MAE: 1278.1325 | R-squared: -1.3512 | Avg. Confidence: 1.0000
[Expert 2 | 5-NN | pct=100%] Retrieval MAE: 799.9478 | R-squared: -0.2141 | Avg. Confidence: 0.3036
[Expert 2 | 10-NN | pct=100%] Retrieval MAE: 755.0992 | R-squared: -0.1886 | Avg. Confidence: 0.1792
[Expert 2 | 20-NN | pct=100%] Retrieval MAE: 740.4846 | R-squared: -0.1878 | Avg. Confidence: 0.0964
  - [Expert 2] RF (regression, 80/20): MAE=698.8207 | RMSE=721.8078 | R2=-0.1448 (cases=882 | samples=2623)

--- Evaluating task: regression | Expert 3 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 656 / 13114
[Expert 3 | 1-NN | pct=5%] Retrieval MAE: 1230.9034 | R-squared: -1.5461 | Avg. Confidence: 1.0000
[Expert 3 | 5-NN | pct=5%] Retrieval MAE: 799.5019 | R-squared: -0.2444 | Avg. Confidence: 0.3152
[Expert 3 | 10-NN | pct=5%] Retrieval MAE: 754.7272 | R-squared: -0.2133 | Avg. Confidence: 0.1871
[Expert 3 | 20-NN | pct=5%] Retrieval MAE: 741.7201 | R-squared: -0.2154 | Avg. Confidence: 0.0985

  - Candidate pool sampling: 20%
  - Candidate pool size: 2623 / 13114
[Expert 3 | 1-NN | pct=20%] Retrieval MAE: 1077.1998 | R-squared: -0.7313 | Avg. Confidence: 1.0000
[Expert 3 | 5-NN | pct=20%] Retrieval MAE: 779.6196 | R-squared: -0.1394 | Avg. Confidence: 0.3115
[Expert 3 | 10-NN | pct=20%] Retrieval MAE: 746.9177 | R-squared: -0.1546 | Avg. Confidence: 0.1854
[Expert 3 | 20-NN | pct=20%] Retrieval MAE: 729.5030 | R-squared: -0.1739 | Avg. Confidence: 0.0989

  - Candidate pool sampling: 100%
[Expert 3 | 1-NN | pct=100%] Retrieval MAE: 1135.1721 | R-squared: -1.0744 | Avg. Confidence: 1.0000
[Expert 3 | 5-NN | pct=100%] Retrieval MAE: 798.2052 | R-squared: -0.1921 | Avg. Confidence: 0.3012
[Expert 3 | 10-NN | pct=100%] Retrieval MAE: 745.9151 | R-squared: -0.1835 | Avg. Confidence: 0.1768
[Expert 3 | 20-NN | pct=100%] Retrieval MAE: 735.3704 | R-squared: -0.1782 | Avg. Confidence: 0.0956
  - [Expert 3] RF (regression, 80/20): MAE=698.1793 | RMSE=722.3628 | R2=-0.1360 (cases=882 | samples=2623)

--- Running PCA-kNN Baseline Comparison ---

üî¨ Starting PCA + k-NN Baseline Evaluation...
  - Applying PCA to 13114 embeddings...
  - Reduced dimension from 256 to 128
  - Applying PCA to 13114 embeddings...
  - Reduced dimension from 256 to 128

--- Evaluating PCA-kNN task: classification ---
[1-NN] PCA-kNN Accuracy: 0.4650 (on 200 queries)
[5-NN] PCA-kNN Accuracy: 0.4750 (on 200 queries)
[10-NN] PCA-kNN Accuracy: 0.5250 (on 200 queries)
[20-NN] PCA-kNN Accuracy: 0.5300 (on 200 queries)

--- Evaluating PCA-kNN task: regression ---
[1-NN] PCA-kNN MAE: 1237.5353 | R-squared: -0.8291
[5-NN] PCA-kNN MAE: 881.4401 | R-squared: -0.1900
[10-NN] PCA-kNN MAE: 865.4642 | R-squared: -0.1843
[20-NN] PCA-kNN MAE: 852.0444 | R-squared: -0.1835

# Traditional

Log path: C:/sepsis.xes
Activity key: concept:name
Activities: 16
Paths: 115
Samples (prefixes): 14164
Feature dimension: 134
Target classes: 16
Train size: 11331
Test size: 2833
Training sample %: 5
Train size (sampled): 567
RF test accuracy: 0.5665
RF intra_centroid_cos (mean): 0.7100
RF inter_centroid_cos (mean): 0.1710
RF centroid_margin (mean): 0.0344
RF knn_purity@5 (mean): 0.3568
RF knn_purity@10 (mean): 0.3451
PCA+kNN (k=1) test accuracy: 0.3512 (components: 2)
PCA intra_centroid_cos (mean): 0.7180
PCA inter_centroid_cos (mean): 0.1654
PCA centroid_margin (mean): 0.0345
PCA knn_purity@5 (mean): 0.2746
PCA knn_purity@10 (mean): 0.2683
Training sample %: 20
Train size (sampled): 2266
RF test accuracy: 0.5739
RF intra_centroid_cos (mean): 0.7100
RF inter_centroid_cos (mean): 0.1710
RF centroid_margin (mean): 0.0344
RF knn_purity@5 (mean): 0.3568
RF knn_purity@10 (mean): 0.3451
PCA+kNN (k=1) test accuracy: 0.3618 (components: 2)
PCA intra_centroid_cos (mean): 0.7183
PCA inter_centroid_cos (mean): 0.1655
PCA centroid_margin (mean): 0.0344
PCA knn_purity@5 (mean): 0.2696
PCA knn_purity@10 (mean): 0.2676
Training sample %: 100
Train size (sampled): 11331
RF test accuracy: 0.5980
RF intra_centroid_cos (mean): 0.7100
RF inter_centroid_cos (mean): 0.1710
RF centroid_margin (mean): 0.0344
RF knn_purity@5 (mean): 0.3568
RF knn_purity@10 (mean): 0.3451
PCA+kNN (k=1) test accuracy: 0.3844 (components: 2)
PCA intra_centroid_cos (mean): 0.7182
PCA inter_centroid_cos (mean): 0.1655
PCA centroid_margin (mean): 0.0344
PCA knn_purity@5 (mean): 0.2708
PCA knn_purity@10 (mean): 0.2683

Log path: C:/sepsis.xes
Activity key: concept:name
Timestamp key: time:timestamp
Activities: 16
Paths: 115
Samples (prefixes): 14164
Feature dimension: 134
Train size: 11331
Test size: 2833
Training sample %: 5
Train size (sampled): 567
Per-case MAE (hours): 976.7419
Per-case RMSE (hours): 1064.0734
R2: -0.1366
PCA+kNN (k=1) MAE (hours): 1162.9055 RMSE (hours): 1409.9909 R2: -1.1838 (components: 2)
Training sample %: 20
Train size (sampled): 2266
Per-case MAE (hours): 876.2230
Per-case RMSE (hours): 951.6987
R2: 0.1257
PCA+kNN (k=1) MAE (hours): 1072.1343 RMSE (hours): 1292.5498 R2: -0.8973 (components: 2)
Training sample %: 100
Train size (sampled): 11331
Per-case MAE (hours): 767.6151
Per-case RMSE (hours): 851.1176
R2: 0.2787
PCA+kNN (k=1) MAE (hours): 1128.5059 RMSE (hours): 1356.2275 R2: -0.9906 (components: 2)



!# HELPDESK EVENT LOG

# Foundation Model

--- üöÄ Initializing Test Run with Configuration ---
Loading training config from ./checkpoints/training_config.pth to match model...
  - Test Log: Found direct path: logs/helpdesk.xes
  - Test Mode: retrieval_augmented
  - Test Episodes: 200
  - Checkpoint Directory: ./checkpoints
  - Checkpoint Epoch: Latest
  - Retrieval K-values: [1, 5, 10, 20]
  - Retrieval Candidate %: [5, 20, 100]
--- Running Testing Script in Stand-Alone Mode (strategy: 'learned') ---
Using device: cuda

üì¶ Loading test data...
Data loader initialized with strategy: 'learned'
‚úÖ Training artifacts loaded successfully from ./checkpoints/training_artifacts.pth
Transforming log: 'helpdesk' from /home/berti/events-transf/logs/helpdesk.xes

Transforming logs: ['helpdesk']
‚úÖ Transformation complete.
‚úÖ Initialized MoEModel with 4 expert(s).
Character vocabulary set in LearnedEventEmbedder.
Character vocabulary set in LearnedEventEmbedder.
Character vocabulary set in LearnedEventEmbedder.
Character vocabulary set in LearnedEventEmbedder.
üîç Found latest checkpoint: model_epoch_10.pth
üíæ Loading weights from ./checkpoints/model_epoch_10.pth...

üõ†Ô∏è Creating test tasks...

--- Running in Retrieval-Augmented Evaluation Mode ---

üî¨ Starting Retrieval-Augmented Evaluation...
  - (MoE) Running k-NN eval for all 4 experts.
  - [Expert 0] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 0] Case ID stats: unique_cases=4579, total_tasks=12188
  - [Expert 0] Top case_id counts: [(np.str_('Case 1820'), 13), (np.str_('Case 1499'), 12), (np.str_('Case 2368'), 12), (np.str_('Case 3835'), 11), (np.str_('Case 1245'), 11)]
  - [Expert 0] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.5190 | inter_centroid_cos=0.1246 | centroid_margin=0.2055 | knn_purity@5=0.6698 knn_purity@10=0.6696
  - [Expert 0] Pre-computed 12188 embeddings for classification.
  - [Expert 0] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 0] Case ID stats: unique_cases=4579, total_tasks=12188
  - [Expert 0] Top case_id counts: [(np.str_('Case 1820'), 13), (np.str_('Case 1499'), 12), (np.str_('Case 2368'), 12), (np.str_('Case 3835'), 11), (np.str_('Case 1245'), 11)]
  - [Expert 0] Pre-computed 12188 embeddings for regression.
  - [Expert 1] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 1] Case ID stats: unique_cases=4579, total_tasks=12188
  - [Expert 1] Top case_id counts: [(np.str_('Case 1820'), 13), (np.str_('Case 1499'), 12), (np.str_('Case 2368'), 12), (np.str_('Case 3835'), 11), (np.str_('Case 1245'), 11)]
  - [Expert 1] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.7145 | inter_centroid_cos=0.0722 | centroid_margin=0.0851 | knn_purity@5=0.6960 knn_purity@10=0.6945
  - [Expert 1] Pre-computed 12188 embeddings for classification.
  - [Expert 1] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 1] Case ID stats: unique_cases=4579, total_tasks=12188
  - [Expert 1] Top case_id counts: [(np.str_('Case 1820'), 13), (np.str_('Case 1499'), 12), (np.str_('Case 2368'), 12), (np.str_('Case 3835'), 11), (np.str_('Case 1245'), 11)]
  - [Expert 1] Pre-computed 12188 embeddings for regression.
  - [Expert 2] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 2] Case ID stats: unique_cases=4579, total_tasks=12188
  - [Expert 2] Top case_id counts: [(np.str_('Case 1820'), 13), (np.str_('Case 1499'), 12), (np.str_('Case 2368'), 12), (np.str_('Case 3835'), 11), (np.str_('Case 1245'), 11)]
  - [Expert 2] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.5671 | inter_centroid_cos=0.0353 | centroid_margin=0.1286 | knn_purity@5=0.6770 knn_purity@10=0.6725
  - [Expert 2] Pre-computed 12188 embeddings for classification.
  - [Expert 2] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 2] Case ID stats: unique_cases=4579, total_tasks=12188
  - [Expert 2] Top case_id counts: [(np.str_('Case 1820'), 13), (np.str_('Case 1499'), 12), (np.str_('Case 2368'), 12), (np.str_('Case 3835'), 11), (np.str_('Case 1245'), 11)]
  - [Expert 2] Pre-computed 12188 embeddings for regression.
  - [Expert 3] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 3] Case ID stats: unique_cases=4579, total_tasks=12188
  - [Expert 3] Top case_id counts: [(np.str_('Case 1820'), 13), (np.str_('Case 1499'), 12), (np.str_('Case 2368'), 12), (np.str_('Case 3835'), 11), (np.str_('Case 1245'), 11)]
  - [Expert 3] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.5775 | inter_centroid_cos=-0.0030 | centroid_margin=0.0776 | knn_purity@5=0.6474 knn_purity@10=0.6459
  - [Expert 3] Pre-computed 12188 embeddings for classification.
  - [Expert 3] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 3] Case ID stats: unique_cases=4579, total_tasks=12188
  - [Expert 3] Top case_id counts: [(np.str_('Case 1820'), 13), (np.str_('Case 1499'), 12), (np.str_('Case 2368'), 12), (np.str_('Case 3835'), 11), (np.str_('Case 1245'), 11)]
  - [Expert 3] Pre-computed 12188 embeddings for regression.
  - Inter-expert metrics (classification) Expert 0 vs Expert 1: mean_cos=-0.1191 | mean_l2=1.4960 | centroid_cos_mean=-0.1247
  - Inter-expert metrics (classification) Expert 0 vs Expert 2: mean_cos=0.0321 | mean_l2=1.3911 | centroid_cos_mean=0.0373
  - Inter-expert metrics (classification) Expert 0 vs Expert 3: mean_cos=0.0692 | mean_l2=1.3641 | centroid_cos_mean=0.0707
  - Inter-expert metrics (classification) Expert 1 vs Expert 2: mean_cos=0.0339 | mean_l2=1.3900 | centroid_cos_mean=0.0367
  - Inter-expert metrics (classification) Expert 1 vs Expert 3: mean_cos=-0.1594 | mean_l2=1.5226 | centroid_cos_mean=-0.1632
  - Inter-expert metrics (classification) Expert 2 vs Expert 3: mean_cos=-0.0456 | mean_l2=1.4459 | centroid_cos_mean=-0.0385
  - Inter-expert metrics (regression) Expert 0 vs Expert 1: mean_cos=-0.1191 | mean_l2=1.4960
  - Inter-expert metrics (regression) Expert 0 vs Expert 2: mean_cos=0.0321 | mean_l2=1.3911
  - Inter-expert metrics (regression) Expert 0 vs Expert 3: mean_cos=0.0692 | mean_l2=1.3641
  - Inter-expert metrics (regression) Expert 1 vs Expert 2: mean_cos=0.0339 | mean_l2=1.3900
  - Inter-expert metrics (regression) Expert 1 vs Expert 3: mean_cos=-0.1594 | mean_l2=1.5226
  - Inter-expert metrics (regression) Expert 2 vs Expert 3: mean_cos=-0.0456 | mean_l2=1.4459

--- Evaluating task: classification | Expert 0 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 610 / 12188
[Expert 0 | 1-NN | pct=5%] Retrieval Accuracy: 0.6150 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 0 | 5-NN | pct=5%] Retrieval Accuracy: 0.5900 | Avg. Confidence: 0.6454 (on 200 queries)
[Expert 0 | 10-NN | pct=5%] Retrieval Accuracy: 0.5600 | Avg. Confidence: 0.5226 (on 200 queries)
[Expert 0 | 20-NN | pct=5%] Retrieval Accuracy: 0.5050 | Avg. Confidence: 0.4042 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 2438 / 12188
[Expert 0 | 1-NN | pct=20%] Retrieval Accuracy: 0.6650 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 0 | 5-NN | pct=20%] Retrieval Accuracy: 0.6700 | Avg. Confidence: 0.6803 (on 200 queries)
[Expert 0 | 10-NN | pct=20%] Retrieval Accuracy: 0.6550 | Avg. Confidence: 0.5675 (on 200 queries)
[Expert 0 | 20-NN | pct=20%] Retrieval Accuracy: 0.6150 | Avg. Confidence: 0.4526 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 0 | 1-NN | pct=100%] Retrieval Accuracy: 0.6650 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 0 | 5-NN | pct=100%] Retrieval Accuracy: 0.6850 | Avg. Confidence: 0.6569 (on 200 queries)
[Expert 0 | 10-NN | pct=100%] Retrieval Accuracy: 0.6350 | Avg. Confidence: 0.5484 (on 200 queries)
[Expert 0 | 20-NN | pct=100%] Retrieval Accuracy: 0.6050 | Avg. Confidence: 0.4565 (on 200 queries)
  - [Expert 0] RF (classification, 80/20): Accuracy=0.6907 (n=2438)

--- Evaluating task: classification | Expert 1 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 610 / 12188
[Expert 1 | 1-NN | pct=5%] Retrieval Accuracy: 0.5950 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 1 | 5-NN | pct=5%] Retrieval Accuracy: 0.5800 | Avg. Confidence: 0.6254 (on 200 queries)
[Expert 1 | 10-NN | pct=5%] Retrieval Accuracy: 0.5750 | Avg. Confidence: 0.4939 (on 200 queries)
[Expert 1 | 20-NN | pct=5%] Retrieval Accuracy: 0.4200 | Avg. Confidence: 0.4088 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 2438 / 12188
[Expert 1 | 1-NN | pct=20%] Retrieval Accuracy: 0.6650 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 1 | 5-NN | pct=20%] Retrieval Accuracy: 0.7100 | Avg. Confidence: 0.6606 (on 200 queries)
[Expert 1 | 10-NN | pct=20%] Retrieval Accuracy: 0.6450 | Avg. Confidence: 0.5528 (on 200 queries)
[Expert 1 | 20-NN | pct=20%] Retrieval Accuracy: 0.5850 | Avg. Confidence: 0.4581 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 1 | 1-NN | pct=100%] Retrieval Accuracy: 0.6950 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 1 | 5-NN | pct=100%] Retrieval Accuracy: 0.6700 | Avg. Confidence: 0.6605 (on 200 queries)
[Expert 1 | 10-NN | pct=100%] Retrieval Accuracy: 0.6400 | Avg. Confidence: 0.5449 (on 200 queries)
[Expert 1 | 20-NN | pct=100%] Retrieval Accuracy: 0.6300 | Avg. Confidence: 0.4551 (on 200 queries)
  - [Expert 1] RF (classification, 80/20): Accuracy=0.6928 (n=2438)

--- Evaluating task: classification | Expert 2 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 610 / 12188
[Expert 2 | 1-NN | pct=5%] Retrieval Accuracy: 0.6100 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 2 | 5-NN | pct=5%] Retrieval Accuracy: 0.5850 | Avg. Confidence: 0.6470 (on 200 queries)
[Expert 2 | 10-NN | pct=5%] Retrieval Accuracy: 0.5500 | Avg. Confidence: 0.5123 (on 200 queries)
[Expert 2 | 20-NN | pct=5%] Retrieval Accuracy: 0.4800 | Avg. Confidence: 0.4000 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 2438 / 12188
[Expert 2 | 1-NN | pct=20%] Retrieval Accuracy: 0.6650 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 2 | 5-NN | pct=20%] Retrieval Accuracy: 0.6700 | Avg. Confidence: 0.6808 (on 200 queries)
[Expert 2 | 10-NN | pct=20%] Retrieval Accuracy: 0.6500 | Avg. Confidence: 0.5623 (on 200 queries)
[Expert 2 | 20-NN | pct=20%] Retrieval Accuracy: 0.6150 | Avg. Confidence: 0.4649 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 2 | 1-NN | pct=100%] Retrieval Accuracy: 0.6900 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 2 | 5-NN | pct=100%] Retrieval Accuracy: 0.6600 | Avg. Confidence: 0.6666 (on 200 queries)
[Expert 2 | 10-NN | pct=100%] Retrieval Accuracy: 0.6500 | Avg. Confidence: 0.5575 (on 200 queries)
[Expert 2 | 20-NN | pct=100%] Retrieval Accuracy: 0.5850 | Avg. Confidence: 0.4628 (on 200 queries)
  - [Expert 2] RF (classification, 80/20): Accuracy=0.6973 (n=2438)

--- Evaluating task: classification | Expert 3 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 610 / 12188
[Expert 3 | 1-NN | pct=5%] Retrieval Accuracy: 0.6100 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 3 | 5-NN | pct=5%] Retrieval Accuracy: 0.5650 | Avg. Confidence: 0.6266 (on 200 queries)
[Expert 3 | 10-NN | pct=5%] Retrieval Accuracy: 0.5400 | Avg. Confidence: 0.5048 (on 200 queries)
[Expert 3 | 20-NN | pct=5%] Retrieval Accuracy: 0.4900 | Avg. Confidence: 0.4096 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 2438 / 12188
[Expert 3 | 1-NN | pct=20%] Retrieval Accuracy: 0.6750 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 3 | 5-NN | pct=20%] Retrieval Accuracy: 0.6700 | Avg. Confidence: 0.6748 (on 200 queries)
[Expert 3 | 10-NN | pct=20%] Retrieval Accuracy: 0.6150 | Avg. Confidence: 0.5613 (on 200 queries)
[Expert 3 | 20-NN | pct=20%] Retrieval Accuracy: 0.5900 | Avg. Confidence: 0.4669 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 3 | 1-NN | pct=100%] Retrieval Accuracy: 0.6950 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 3 | 5-NN | pct=100%] Retrieval Accuracy: 0.6700 | Avg. Confidence: 0.6781 (on 200 queries)
[Expert 3 | 10-NN | pct=100%] Retrieval Accuracy: 0.6350 | Avg. Confidence: 0.5478 (on 200 queries)
[Expert 3 | 20-NN | pct=100%] Retrieval Accuracy: 0.5450 | Avg. Confidence: 0.4536 (on 200 queries)
  - [Expert 3] RF (classification, 80/20): Accuracy=0.6989 (n=2438)

--- Evaluating task: regression | Expert 0 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 610 / 12188
[Expert 0 | 1-NN | pct=5%] Retrieval MAE: 0.1981 | R-squared: 0.1038 | Avg. Confidence: 1.0000
[Expert 0 | 5-NN | pct=5%] Retrieval MAE: 0.1672 | R-squared: 0.4633 | Avg. Confidence: 0.3346
[Expert 0 | 10-NN | pct=5%] Retrieval MAE: 0.1631 | R-squared: 0.5132 | Avg. Confidence: 0.1980
[Expert 0 | 20-NN | pct=5%] Retrieval MAE: 0.1662 | R-squared: 0.5094 | Avg. Confidence: 0.1042

  - Candidate pool sampling: 20%
  - Candidate pool size: 2438 / 12188
[Expert 0 | 1-NN | pct=20%] Retrieval MAE: 0.2178 | R-squared: -0.0720 | Avg. Confidence: 1.0000
[Expert 0 | 5-NN | pct=20%] Retrieval MAE: 0.1781 | R-squared: 0.3653 | Avg. Confidence: 0.3137
[Expert 0 | 10-NN | pct=20%] Retrieval MAE: 0.1796 | R-squared: 0.3992 | Avg. Confidence: 0.1821
[Expert 0 | 20-NN | pct=20%] Retrieval MAE: 0.1810 | R-squared: 0.4244 | Avg. Confidence: 0.1001

  - Candidate pool sampling: 100%
[Expert 0 | 1-NN | pct=100%] Retrieval MAE: 0.2124 | R-squared: -0.0235 | Avg. Confidence: 1.0000
[Expert 0 | 5-NN | pct=100%] Retrieval MAE: 0.1701 | R-squared: 0.3852 | Avg. Confidence: 0.2829
[Expert 0 | 10-NN | pct=100%] Retrieval MAE: 0.1708 | R-squared: 0.4124 | Avg. Confidence: 0.1654
[Expert 0 | 20-NN | pct=100%] Retrieval MAE: 0.1711 | R-squared: 0.4347 | Avg. Confidence: 0.0879
  - [Expert 0] RF (regression, 80/20): MAE=0.1612 | RMSE=0.1640 | R2=0.4764 (cases=1982 | samples=2438)

--- Evaluating task: regression | Expert 1 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 610 / 12188
[Expert 1 | 1-NN | pct=5%] Retrieval MAE: 0.1852 | R-squared: 0.1944 | Avg. Confidence: 1.0000
[Expert 1 | 5-NN | pct=5%] Retrieval MAE: 0.1713 | R-squared: 0.4377 | Avg. Confidence: 0.3314
[Expert 1 | 10-NN | pct=5%] Retrieval MAE: 0.1662 | R-squared: 0.4962 | Avg. Confidence: 0.1950
[Expert 1 | 20-NN | pct=5%] Retrieval MAE: 0.1681 | R-squared: 0.5112 | Avg. Confidence: 0.1041

  - Candidate pool sampling: 20%
  - Candidate pool size: 2438 / 12188
[Expert 1 | 1-NN | pct=20%] Retrieval MAE: 0.2023 | R-squared: 0.0666 | Avg. Confidence: 1.0000
[Expert 1 | 5-NN | pct=20%] Retrieval MAE: 0.1720 | R-squared: 0.4120 | Avg. Confidence: 0.3133
[Expert 1 | 10-NN | pct=20%] Retrieval MAE: 0.1749 | R-squared: 0.4323 | Avg. Confidence: 0.1818
[Expert 1 | 20-NN | pct=20%] Retrieval MAE: 0.1784 | R-squared: 0.4415 | Avg. Confidence: 0.0996

  - Candidate pool sampling: 100%
[Expert 1 | 1-NN | pct=100%] Retrieval MAE: 0.2070 | R-squared: 0.0318 | Avg. Confidence: 1.0000
[Expert 1 | 5-NN | pct=100%] Retrieval MAE: 0.1602 | R-squared: 0.4535 | Avg. Confidence: 0.2830
[Expert 1 | 10-NN | pct=100%] Retrieval MAE: 0.1606 | R-squared: 0.4757 | Avg. Confidence: 0.1638
[Expert 1 | 20-NN | pct=100%] Retrieval MAE: 0.1610 | R-squared: 0.4893 | Avg. Confidence: 0.0891
  - [Expert 1] RF (regression, 80/20): MAE=0.1601 | RMSE=0.1629 | R2=0.4838 (cases=1982 | samples=2438)

--- Evaluating task: regression | Expert 2 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 610 / 12188
[Expert 2 | 1-NN | pct=5%] Retrieval MAE: 0.1993 | R-squared: 0.0951 | Avg. Confidence: 1.0000
[Expert 2 | 5-NN | pct=5%] Retrieval MAE: 0.1726 | R-squared: 0.4172 | Avg. Confidence: 0.3358
[Expert 2 | 10-NN | pct=5%] Retrieval MAE: 0.1678 | R-squared: 0.4884 | Avg. Confidence: 0.1975
[Expert 2 | 20-NN | pct=5%] Retrieval MAE: 0.1724 | R-squared: 0.4789 | Avg. Confidence: 0.1040

  - Candidate pool sampling: 20%
  - Candidate pool size: 2438 / 12188
[Expert 2 | 1-NN | pct=20%] Retrieval MAE: 0.2296 | R-squared: -0.1453 | Avg. Confidence: 1.0000
[Expert 2 | 5-NN | pct=20%] Retrieval MAE: 0.1752 | R-squared: 0.3799 | Avg. Confidence: 0.3345
[Expert 2 | 10-NN | pct=20%] Retrieval MAE: 0.1762 | R-squared: 0.4150 | Avg. Confidence: 0.1963
[Expert 2 | 20-NN | pct=20%] Retrieval MAE: 0.1794 | R-squared: 0.4242 | Avg. Confidence: 0.1045

  - Candidate pool sampling: 100%
[Expert 2 | 1-NN | pct=100%] Retrieval MAE: 0.2198 | R-squared: -0.0665 | Avg. Confidence: 1.0000
[Expert 2 | 5-NN | pct=100%] Retrieval MAE: 0.1757 | R-squared: 0.3563 | Avg. Confidence: 0.2979
[Expert 2 | 10-NN | pct=100%] Retrieval MAE: 0.1704 | R-squared: 0.4115 | Avg. Confidence: 0.1746
[Expert 2 | 20-NN | pct=100%] Retrieval MAE: 0.1696 | R-squared: 0.4437 | Avg. Confidence: 0.0956
  - [Expert 2] RF (regression, 80/20): MAE=0.1608 | RMSE=0.1637 | R2=0.4791 (cases=1982 | samples=2438)

--- Evaluating task: regression | Expert 3 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 610 / 12188
[Expert 3 | 1-NN | pct=5%] Retrieval MAE: 0.1909 | R-squared: 0.1581 | Avg. Confidence: 1.0000
[Expert 3 | 5-NN | pct=5%] Retrieval MAE: 0.1633 | R-squared: 0.4736 | Avg. Confidence: 0.3435
[Expert 3 | 10-NN | pct=5%] Retrieval MAE: 0.1593 | R-squared: 0.5195 | Avg. Confidence: 0.2003
[Expert 3 | 20-NN | pct=5%] Retrieval MAE: 0.1676 | R-squared: 0.5074 | Avg. Confidence: 0.1054

  - Candidate pool sampling: 20%
  - Candidate pool size: 2438 / 12188
[Expert 3 | 1-NN | pct=20%] Retrieval MAE: 0.2175 | R-squared: -0.0686 | Avg. Confidence: 1.0000
[Expert 3 | 5-NN | pct=20%] Retrieval MAE: 0.1741 | R-squared: 0.3741 | Avg. Confidence: 0.3296
[Expert 3 | 10-NN | pct=20%] Retrieval MAE: 0.1729 | R-squared: 0.4309 | Avg. Confidence: 0.1945
[Expert 3 | 20-NN | pct=20%] Retrieval MAE: 0.1791 | R-squared: 0.4329 | Avg. Confidence: 0.1046

  - Candidate pool sampling: 100%
[Expert 3 | 1-NN | pct=100%] Retrieval MAE: 0.1982 | R-squared: 0.0742 | Avg. Confidence: 1.0000
[Expert 3 | 5-NN | pct=100%] Retrieval MAE: 0.1697 | R-squared: 0.3854 | Avg. Confidence: 0.2909
[Expert 3 | 10-NN | pct=100%] Retrieval MAE: 0.1678 | R-squared: 0.4222 | Avg. Confidence: 0.1716
[Expert 3 | 20-NN | pct=100%] Retrieval MAE: 0.1650 | R-squared: 0.4646 | Avg. Confidence: 0.0938
  - [Expert 3] RF (regression, 80/20): MAE=0.1603 | RMSE=0.1630 | R2=0.4782 (cases=1982 | samples=2438)

--- Running PCA-kNN Baseline Comparison ---

üî¨ Starting PCA + k-NN Baseline Evaluation...
  - Applying PCA to 12188 embeddings...
  - Reduced dimension from 256 to 128
  - Applying PCA to 12188 embeddings...
  - Reduced dimension from 256 to 128

--- Evaluating PCA-kNN task: classification ---
[1-NN] PCA-kNN Accuracy: 0.6700 (on 200 queries)
[5-NN] PCA-kNN Accuracy: 0.7450 (on 200 queries)
[10-NN] PCA-kNN Accuracy: 0.7750 (on 200 queries)
[20-NN] PCA-kNN Accuracy: 0.7550 (on 200 queries)

--- Evaluating PCA-kNN task: regression ---
[1-NN] PCA-kNN MAE: 0.2274 | R-squared: -0.0387
[5-NN] PCA-kNN MAE: 0.1712 | R-squared: 0.3984
[10-NN] PCA-kNN MAE: 0.1660 | R-squared: 0.4569
[20-NN] PCA-kNN MAE: 0.1700 | R-squared: 0.4637


# Traditional

Log path: C:/helpdesk.xes
Activity key: concept:name
Activities: 14
Paths: 55
Samples (prefixes): 16768
Feature dimension: 72
Target classes: 14
Train size: 13414
Test size: 3354
Training sample %: 5
Train size (sampled): 671
RF test accuracy: 0.7478
RF intra_centroid_cos (mean): 0.6843
RF inter_centroid_cos (mean): 0.1923
RF centroid_margin (mean): 0.0886
RF knn_purity@5 (mean): 0.6428
RF knn_purity@10 (mean): 0.6251
PCA+kNN (k=1) test accuracy: 0.5957 (components: 2)
PCA intra_centroid_cos (mean): 0.6936
PCA inter_centroid_cos (mean): 0.2193
PCA centroid_margin (mean): 0.0559
PCA knn_purity@5 (mean): 0.5668
PCA knn_purity@10 (mean): 0.5618
Training sample %: 20
Train size (sampled): 2683
RF test accuracy: 0.7728
RF intra_centroid_cos (mean): 0.6843
RF inter_centroid_cos (mean): 0.1923
RF centroid_margin (mean): 0.0886
RF knn_purity@5 (mean): 0.6428
RF knn_purity@10 (mean): 0.6251
PCA+kNN (k=1) test accuracy: 0.6109 (components: 2)
PCA intra_centroid_cos (mean): 0.6930
PCA inter_centroid_cos (mean): 0.2196
PCA centroid_margin (mean): 0.0564
PCA knn_purity@5 (mean): 0.5650
PCA knn_purity@10 (mean): 0.5628
Training sample %: 100
Train size (sampled): 13414
RF test accuracy: 0.7636
RF intra_centroid_cos (mean): 0.6843
RF inter_centroid_cos (mean): 0.1923
RF centroid_margin (mean): 0.0886
RF knn_purity@5 (mean): 0.6428
RF knn_purity@10 (mean): 0.6251
PCA+kNN (k=1) test accuracy: 0.6312 (components: 2)
PCA intra_centroid_cos (mean): 0.6931
PCA inter_centroid_cos (mean): 0.2192
PCA centroid_margin (mean): 0.0564
PCA knn_purity@5 (mean): 0.5656
PCA knn_purity@10 (mean): 0.5624

Log path: C:/helpdesk.xes
Activity key: concept:name
Timestamp key: time:timestamp
Activities: 14
Paths: 55
Samples (prefixes): 16768
Feature dimension: 72
Train size: 13414
Test size: 3354
Training sample %: 5
Train size (sampled): 671
Per-case MAE (hours): 0.1227
Per-case RMSE (hours): 0.1296
R2: 0.8195
PCA+kNN (k=1) MAE (hours): 0.1593 RMSE (hours): 0.1699 R2: 0.6836 (components: 2)
Training sample %: 20
Train size (sampled): 2683
Per-case MAE (hours): 0.1186
Per-case RMSE (hours): 0.1256
R2: 0.8237
PCA+kNN (k=1) MAE (hours): 0.1529 RMSE (hours): 0.1636 R2: 0.6989 (components: 2)
Training sample %: 100
Train size (sampled): 13414
Per-case MAE (hours): 0.1174
Per-case RMSE (hours): 0.1242
R2: 0.8307
PCA+kNN (k=1) MAE (hours): 0.1543 RMSE (hours): 0.1639 R2: 0.7009 (components: 2)



!# BILLING EVENT LOG

# Foundation Model

--- üöÄ Initializing Test Run with Configuration ---
Loading training config from ./checkpoints/training_config.pth to match model...
  - Test Log: Found direct path: logs/billing.xes.gz
  - Test Mode: retrieval_augmented
  - Test Episodes: 200
  - Checkpoint Directory: ./checkpoints
  - Checkpoint Epoch: Latest
  - Retrieval K-values: [1, 5, 10, 20]
  - Retrieval Candidate %: [5, 20, 100]
--- Running Testing Script in Stand-Alone Mode (strategy: 'learned') ---
Using device: cuda

üì¶ Loading test data...
Data loader initialized with strategy: 'learned'
‚úÖ Training artifacts loaded successfully from ./checkpoints/training_artifacts.pth
Transforming log: 'billing' from /home/berti/events-transf/logs/billing.xes.gz

Transforming logs: ['billing']
‚úÖ Transformation complete.
‚úÖ Initialized MoEModel with 4 expert(s).
Character vocabulary set in LearnedEventEmbedder.
Character vocabulary set in LearnedEventEmbedder.
Character vocabulary set in LearnedEventEmbedder.
Character vocabulary set in LearnedEventEmbedder.
üîç Found latest checkpoint: model_epoch_10.pth
üíæ Loading weights from ./checkpoints/model_epoch_10.pth...

üõ†Ô∏è Creating test tasks...

--- Running in Retrieval-Augmented Evaluation Mode ---

üî¨ Starting Retrieval-Augmented Evaluation...
  - (MoE) Running k-NN eval for all 4 experts.
  - [Expert 0] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 0] Case ID stats: unique_cases=69252, total_tasks=273732
  - [Expert 0] Top case_id counts: [(np.str_('MBL'), 215), (np.str_('APH'), 174), (np.str_('WIK'), 155), (np.str_('AQL'), 115), (np.str_('BPH'), 50)]
  - [Expert 0] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.6245 | inter_centroid_cos=0.0457 | centroid_margin=0.1923 | knn_purity@5=0.8846 knn_purity@10=0.8801
  - [Expert 0] Pre-computed 273732 embeddings for classification.
  - [Expert 0] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 0] Case ID stats: unique_cases=69252, total_tasks=273732
  - [Expert 0] Top case_id counts: [(np.str_('MBL'), 215), (np.str_('APH'), 174), (np.str_('WIK'), 155), (np.str_('AQL'), 115), (np.str_('BPH'), 50)]
  - [Expert 0] Pre-computed 273732 embeddings for regression.
  - [Expert 1] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 1] Case ID stats: unique_cases=69252, total_tasks=273732
  - [Expert 1] Top case_id counts: [(np.str_('MBL'), 215), (np.str_('APH'), 174), (np.str_('WIK'), 155), (np.str_('AQL'), 115), (np.str_('BPH'), 50)]
  - [Expert 1] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.7149 | inter_centroid_cos=0.0431 | centroid_margin=0.1917 | knn_purity@5=0.8956 knn_purity@10=0.8901
  - [Expert 1] Pre-computed 273732 embeddings for classification.
  - [Expert 1] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 1] Case ID stats: unique_cases=69252, total_tasks=273732
  - [Expert 1] Top case_id counts: [(np.str_('MBL'), 215), (np.str_('APH'), 174), (np.str_('WIK'), 155), (np.str_('AQL'), 115), (np.str_('BPH'), 50)]
  - [Expert 1] Pre-computed 273732 embeddings for regression.
  - [Expert 2] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 2] Case ID stats: unique_cases=69252, total_tasks=273732
  - [Expert 2] Top case_id counts: [(np.str_('MBL'), 215), (np.str_('APH'), 174), (np.str_('WIK'), 155), (np.str_('AQL'), 115), (np.str_('BPH'), 50)]
  - [Expert 2] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.6233 | inter_centroid_cos=0.0169 | centroid_margin=0.1487 | knn_purity@5=0.8776 knn_purity@10=0.8792
  - [Expert 2] Pre-computed 273732 embeddings for classification.
  - [Expert 2] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 2] Case ID stats: unique_cases=69252, total_tasks=273732
  - [Expert 2] Top case_id counts: [(np.str_('MBL'), 215), (np.str_('APH'), 174), (np.str_('WIK'), 155), (np.str_('AQL'), 115), (np.str_('BPH'), 50)]
  - [Expert 2] Pre-computed 273732 embeddings for regression.
  - [Expert 3] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 3] Case ID stats: unique_cases=69252, total_tasks=273732
  - [Expert 3] Top case_id counts: [(np.str_('MBL'), 215), (np.str_('APH'), 174), (np.str_('WIK'), 155), (np.str_('AQL'), 115), (np.str_('BPH'), 50)]
  - [Expert 3] Similarity metrics (mean, mean-centered cosine): intra_centroid_cos=0.6292 | inter_centroid_cos=0.0658 | centroid_margin=0.2002 | knn_purity@5=0.8700 knn_purity@10=0.8678
  - [Expert 3] Pre-computed 273732 embeddings for classification.
  - [Expert 3] Embedding sanity: has_nan=False, all_finite=True
  - [Expert 3] Case ID stats: unique_cases=69252, total_tasks=273732
  - [Expert 3] Top case_id counts: [(np.str_('MBL'), 215), (np.str_('APH'), 174), (np.str_('WIK'), 155), (np.str_('AQL'), 115), (np.str_('BPH'), 50)]
  - [Expert 3] Pre-computed 273732 embeddings for regression.
  - Inter-expert metrics (classification) Expert 0 vs Expert 1: mean_cos=-0.0526 | mean_l2=1.4508 | centroid_cos_mean=-0.0603
  - Inter-expert metrics (classification) Expert 0 vs Expert 2: mean_cos=0.0231 | mean_l2=1.3977 | centroid_cos_mean=0.0183
  - Inter-expert metrics (classification) Expert 0 vs Expert 3: mean_cos=0.0503 | mean_l2=1.3780 | centroid_cos_mean=0.0537
  - Inter-expert metrics (classification) Expert 1 vs Expert 2: mean_cos=0.0058 | mean_l2=1.4100 | centroid_cos_mean=0.0179
  - Inter-expert metrics (classification) Expert 1 vs Expert 3: mean_cos=0.0001 | mean_l2=1.4132 | centroid_cos_mean=0.0125
  - Inter-expert metrics (classification) Expert 2 vs Expert 3: mean_cos=0.0803 | mean_l2=1.3555 | centroid_cos_mean=0.1029
  - Inter-expert metrics (regression) Expert 0 vs Expert 1: mean_cos=-0.0526 | mean_l2=1.4508
  - Inter-expert metrics (regression) Expert 0 vs Expert 2: mean_cos=0.0231 | mean_l2=1.3977
  - Inter-expert metrics (regression) Expert 0 vs Expert 3: mean_cos=0.0503 | mean_l2=1.3780
  - Inter-expert metrics (regression) Expert 1 vs Expert 2: mean_cos=0.0058 | mean_l2=1.4100
  - Inter-expert metrics (regression) Expert 1 vs Expert 3: mean_cos=0.0001 | mean_l2=1.4132
  - Inter-expert metrics (regression) Expert 2 vs Expert 3: mean_cos=0.0803 | mean_l2=1.3555

--- Evaluating task: classification | Expert 0 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 13687 / 273732
[Expert 0 | 1-NN | pct=5%] Retrieval Accuracy: 0.8850 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 0 | 5-NN | pct=5%] Retrieval Accuracy: 0.8900 | Avg. Confidence: 0.8702 (on 200 queries)
[Expert 0 | 10-NN | pct=5%] Retrieval Accuracy: 0.8700 | Avg. Confidence: 0.8088 (on 200 queries)
[Expert 0 | 20-NN | pct=5%] Retrieval Accuracy: 0.8550 | Avg. Confidence: 0.7197 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 54747 / 273732
[Expert 0 | 1-NN | pct=20%] Retrieval Accuracy: 0.9050 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 0 | 5-NN | pct=20%] Retrieval Accuracy: 0.8900 | Avg. Confidence: 0.8652 (on 200 queries)
[Expert 0 | 10-NN | pct=20%] Retrieval Accuracy: 0.8650 | Avg. Confidence: 0.8261 (on 200 queries)
[Expert 0 | 20-NN | pct=20%] Retrieval Accuracy: 0.8300 | Avg. Confidence: 0.7028 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 0 | 1-NN | pct=100%] Retrieval Accuracy: 0.9100 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 0 | 5-NN | pct=100%] Retrieval Accuracy: 0.8800 | Avg. Confidence: 0.8812 (on 200 queries)
[Expert 0 | 10-NN | pct=100%] Retrieval Accuracy: 0.8750 | Avg. Confidence: 0.8159 (on 200 queries)
[Expert 0 | 20-NN | pct=100%] Retrieval Accuracy: 0.8200 | Avg. Confidence: 0.7465 (on 200 queries)
  - [Expert 0] RF (classification, 80/20): Accuracy=0.9075 (n=54747)

--- Evaluating task: classification | Expert 1 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 13687 / 273732
[Expert 1 | 1-NN | pct=5%] Retrieval Accuracy: 0.8950 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 1 | 5-NN | pct=5%] Retrieval Accuracy: 0.9100 | Avg. Confidence: 0.8755 (on 200 queries)
[Expert 1 | 10-NN | pct=5%] Retrieval Accuracy: 0.8900 | Avg. Confidence: 0.8078 (on 200 queries)
[Expert 1 | 20-NN | pct=5%] Retrieval Accuracy: 0.8650 | Avg. Confidence: 0.7318 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 54747 / 273732
[Expert 1 | 1-NN | pct=20%] Retrieval Accuracy: 0.8900 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 1 | 5-NN | pct=20%] Retrieval Accuracy: 0.9050 | Avg. Confidence: 0.8600 (on 200 queries)
[Expert 1 | 10-NN | pct=20%] Retrieval Accuracy: 0.8650 | Avg. Confidence: 0.8086 (on 200 queries)
[Expert 1 | 20-NN | pct=20%] Retrieval Accuracy: 0.8500 | Avg. Confidence: 0.7210 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 1 | 1-NN | pct=100%] Retrieval Accuracy: 0.9150 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 1 | 5-NN | pct=100%] Retrieval Accuracy: 0.9000 | Avg. Confidence: 0.8871 (on 200 queries)
[Expert 1 | 10-NN | pct=100%] Retrieval Accuracy: 0.9250 | Avg. Confidence: 0.8234 (on 200 queries)
[Expert 1 | 20-NN | pct=100%] Retrieval Accuracy: 0.8500 | Avg. Confidence: 0.7707 (on 200 queries)
  - [Expert 1] RF (classification, 80/20): Accuracy=0.9181 (n=54747)

--- Evaluating task: classification | Expert 2 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 13687 / 273732
[Expert 2 | 1-NN | pct=5%] Retrieval Accuracy: 0.9000 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 2 | 5-NN | pct=5%] Retrieval Accuracy: 0.9000 | Avg. Confidence: 0.8719 (on 200 queries)
[Expert 2 | 10-NN | pct=5%] Retrieval Accuracy: 0.8850 | Avg. Confidence: 0.8080 (on 200 queries)
[Expert 2 | 20-NN | pct=5%] Retrieval Accuracy: 0.8600 | Avg. Confidence: 0.7348 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 54747 / 273732
[Expert 2 | 1-NN | pct=20%] Retrieval Accuracy: 0.8950 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 2 | 5-NN | pct=20%] Retrieval Accuracy: 0.8950 | Avg. Confidence: 0.8696 (on 200 queries)
[Expert 2 | 10-NN | pct=20%] Retrieval Accuracy: 0.8800 | Avg. Confidence: 0.8048 (on 200 queries)
[Expert 2 | 20-NN | pct=20%] Retrieval Accuracy: 0.8500 | Avg. Confidence: 0.7249 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 2 | 1-NN | pct=100%] Retrieval Accuracy: 0.9250 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 2 | 5-NN | pct=100%] Retrieval Accuracy: 0.9100 | Avg. Confidence: 0.8907 (on 200 queries)
[Expert 2 | 10-NN | pct=100%] Retrieval Accuracy: 0.8900 | Avg. Confidence: 0.8278 (on 200 queries)
[Expert 2 | 20-NN | pct=100%] Retrieval Accuracy: 0.8350 | Avg. Confidence: 0.7572 (on 200 queries)
  - [Expert 2] RF (classification, 80/20): Accuracy=0.9109 (n=54747)

--- Evaluating task: classification | Expert 3 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 13687 / 273732
[Expert 3 | 1-NN | pct=5%] Retrieval Accuracy: 0.8950 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 3 | 5-NN | pct=5%] Retrieval Accuracy: 0.9050 | Avg. Confidence: 0.8811 (on 200 queries)
[Expert 3 | 10-NN | pct=5%] Retrieval Accuracy: 0.8800 | Avg. Confidence: 0.8007 (on 200 queries)
[Expert 3 | 20-NN | pct=5%] Retrieval Accuracy: 0.8750 | Avg. Confidence: 0.7145 (on 200 queries)

  - Candidate pool sampling: 20%
  - Candidate pool size: 54747 / 273732
[Expert 3 | 1-NN | pct=20%] Retrieval Accuracy: 0.9250 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 3 | 5-NN | pct=20%] Retrieval Accuracy: 0.9100 | Avg. Confidence: 0.8786 (on 200 queries)
[Expert 3 | 10-NN | pct=20%] Retrieval Accuracy: 0.8900 | Avg. Confidence: 0.8165 (on 200 queries)
[Expert 3 | 20-NN | pct=20%] Retrieval Accuracy: 0.8400 | Avg. Confidence: 0.7228 (on 200 queries)

  - Candidate pool sampling: 100%
[Expert 3 | 1-NN | pct=100%] Retrieval Accuracy: 0.9300 | Avg. Confidence: 1.0000 (on 200 queries)
[Expert 3 | 5-NN | pct=100%] Retrieval Accuracy: 0.9150 | Avg. Confidence: 0.8981 (on 200 queries)
[Expert 3 | 10-NN | pct=100%] Retrieval Accuracy: 0.9100 | Avg. Confidence: 0.8371 (on 200 queries)
[Expert 3 | 20-NN | pct=100%] Retrieval Accuracy: 0.8500 | Avg. Confidence: 0.7664 (on 200 queries)
  - [Expert 3] RF (classification, 80/20): Accuracy=0.9182 (n=54747)

--- Evaluating task: regression | Expert 0 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 13687 / 273732
[Expert 0 | 1-NN | pct=5%] Retrieval MAE: 1410.4552 | R-squared: -1.1517 | Avg. Confidence: 1.0000
[Expert 0 | 5-NN | pct=5%] Retrieval MAE: 966.4028 | R-squared: 0.0496 | Avg. Confidence: 0.3024
[Expert 0 | 10-NN | pct=5%] Retrieval MAE: 928.8030 | R-squared: 0.0617 | Avg. Confidence: 0.1744
[Expert 0 | 20-NN | pct=5%] Retrieval MAE: 899.6074 | R-squared: 0.1017 | Avg. Confidence: 0.0905

  - Candidate pool sampling: 20%
  - Candidate pool size: 54747 / 273732
[Expert 0 | 1-NN | pct=20%] Retrieval MAE: 1151.6229 | R-squared: -0.1278 | Avg. Confidence: 1.0000
[Expert 0 | 5-NN | pct=20%] Retrieval MAE: 927.5591 | R-squared: 0.0438 | Avg. Confidence: 0.3091
[Expert 0 | 10-NN | pct=20%] Retrieval MAE: 893.7017 | R-squared: 0.1080 | Avg. Confidence: 0.1800
[Expert 0 | 20-NN | pct=20%] Retrieval MAE: 880.0952 | R-squared: 0.1351 | Avg. Confidence: 0.0948

  - Candidate pool sampling: 100%
[Expert 0 | 1-NN | pct=100%] Retrieval MAE: 1181.0974 | R-squared: -0.4171 | Avg. Confidence: 1.0000
[Expert 0 | 5-NN | pct=100%] Retrieval MAE: 885.0949 | R-squared: 0.1248 | Avg. Confidence: 0.2963
[Expert 0 | 10-NN | pct=100%] Retrieval MAE: 874.7319 | R-squared: 0.1120 | Avg. Confidence: 0.1755
[Expert 0 | 20-NN | pct=100%] Retrieval MAE: 862.1253 | R-squared: 0.1457 | Avg. Confidence: 0.0928
  - [Expert 0] RF (regression, 80/20): MAE=1000.4912 | RMSE=1035.3504 | R2=0.0993 (cases=39169 | samples=54747)

--- Evaluating task: regression | Expert 1 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 13687 / 273732
[Expert 1 | 1-NN | pct=5%] Retrieval MAE: 1591.6159 | R-squared: -1.7501 | Avg. Confidence: 1.0000
[Expert 1 | 5-NN | pct=5%] Retrieval MAE: 986.6035 | R-squared: 0.0099 | Avg. Confidence: 0.2965
[Expert 1 | 10-NN | pct=5%] Retrieval MAE: 922.9126 | R-squared: 0.0696 | Avg. Confidence: 0.1712
[Expert 1 | 20-NN | pct=5%] Retrieval MAE: 895.2268 | R-squared: 0.0983 | Avg. Confidence: 0.0889

  - Candidate pool sampling: 20%
  - Candidate pool size: 54747 / 273732
[Expert 1 | 1-NN | pct=20%] Retrieval MAE: 1315.5473 | R-squared: -0.7629 | Avg. Confidence: 1.0000
[Expert 1 | 5-NN | pct=20%] Retrieval MAE: 984.5654 | R-squared: -0.0570 | Avg. Confidence: 0.3080
[Expert 1 | 10-NN | pct=20%] Retrieval MAE: 900.7615 | R-squared: 0.0881 | Avg. Confidence: 0.1803
[Expert 1 | 20-NN | pct=20%] Retrieval MAE: 878.6662 | R-squared: 0.1300 | Avg. Confidence: 0.0957

  - Candidate pool sampling: 100%
[Expert 1 | 1-NN | pct=100%] Retrieval MAE: 1248.7955 | R-squared: -0.9394 | Avg. Confidence: 1.0000
[Expert 1 | 5-NN | pct=100%] Retrieval MAE: 881.9238 | R-squared: 0.1630 | Avg. Confidence: 0.2962
[Expert 1 | 10-NN | pct=100%] Retrieval MAE: 859.9955 | R-squared: 0.1651 | Avg. Confidence: 0.1754
[Expert 1 | 20-NN | pct=100%] Retrieval MAE: 873.7055 | R-squared: 0.1231 | Avg. Confidence: 0.0927
  - [Expert 1] RF (regression, 80/20): MAE=996.2529 | RMSE=1031.1831 | R2=0.1050 (cases=39169 | samples=54747)

--- Evaluating task: regression | Expert 2 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 13687 / 273732
[Expert 2 | 1-NN | pct=5%] Retrieval MAE: 1337.9326 | R-squared: -0.9105 | Avg. Confidence: 1.0000
[Expert 2 | 5-NN | pct=5%] Retrieval MAE: 976.2824 | R-squared: 0.0286 | Avg. Confidence: 0.3014
[Expert 2 | 10-NN | pct=5%] Retrieval MAE: 940.3685 | R-squared: 0.0495 | Avg. Confidence: 0.1728
[Expert 2 | 20-NN | pct=5%] Retrieval MAE: 935.5362 | R-squared: 0.0317 | Avg. Confidence: 0.0895

  - Candidate pool sampling: 20%
  - Candidate pool size: 54747 / 273732
[Expert 2 | 1-NN | pct=20%] Retrieval MAE: 1244.4899 | R-squared: -0.4355 | Avg. Confidence: 1.0000
[Expert 2 | 5-NN | pct=20%] Retrieval MAE: 975.8044 | R-squared: -0.0629 | Avg. Confidence: 0.3046
[Expert 2 | 10-NN | pct=20%] Retrieval MAE: 919.8008 | R-squared: 0.0365 | Avg. Confidence: 0.1807
[Expert 2 | 20-NN | pct=20%] Retrieval MAE: 891.0903 | R-squared: 0.0853 | Avg. Confidence: 0.0950

  - Candidate pool sampling: 100%
[Expert 2 | 1-NN | pct=100%] Retrieval MAE: 1177.9070 | R-squared: -0.6050 | Avg. Confidence: 1.0000
[Expert 2 | 5-NN | pct=100%] Retrieval MAE: 916.7177 | R-squared: 0.0397 | Avg. Confidence: 0.2990
[Expert 2 | 10-NN | pct=100%] Retrieval MAE: 893.3923 | R-squared: 0.1012 | Avg. Confidence: 0.1777
[Expert 2 | 20-NN | pct=100%] Retrieval MAE: 878.6059 | R-squared: 0.0801 | Avg. Confidence: 0.0943
  - [Expert 2] RF (regression, 80/20): MAE=1002.0869 | RMSE=1037.0638 | R2=0.0978 (cases=39169 | samples=54747)

--- Evaluating task: regression | Expert 3 ---

  - Candidate pool sampling: 5%
  - Candidate pool size: 13687 / 273732
[Expert 3 | 1-NN | pct=5%] Retrieval MAE: 1444.1881 | R-squared: -1.3185 | Avg. Confidence: 1.0000
[Expert 3 | 5-NN | pct=5%] Retrieval MAE: 979.7946 | R-squared: 0.0244 | Avg. Confidence: 0.2983
[Expert 3 | 10-NN | pct=5%] Retrieval MAE: 930.8862 | R-squared: 0.0791 | Avg. Confidence: 0.1739
[Expert 3 | 20-NN | pct=5%] Retrieval MAE: 910.9173 | R-squared: 0.1121 | Avg. Confidence: 0.0911

  - Candidate pool sampling: 20%
  - Candidate pool size: 54747 / 273732
[Expert 3 | 1-NN | pct=20%] Retrieval MAE: 1321.9711 | R-squared: -0.6966 | Avg. Confidence: 1.0000
[Expert 3 | 5-NN | pct=20%] Retrieval MAE: 965.6174 | R-squared: -0.0425 | Avg. Confidence: 0.3050
[Expert 3 | 10-NN | pct=20%] Retrieval MAE: 932.4982 | R-squared: 0.0295 | Avg. Confidence: 0.1793
[Expert 3 | 20-NN | pct=20%] Retrieval MAE: 904.4423 | R-squared: 0.0638 | Avg. Confidence: 0.0945

  - Candidate pool sampling: 100%
[Expert 3 | 1-NN | pct=100%] Retrieval MAE: 1159.8124 | R-squared: -0.5750 | Avg. Confidence: 1.0000
[Expert 3 | 5-NN | pct=100%] Retrieval MAE: 897.0422 | R-squared: 0.0930 | Avg. Confidence: 0.2958
[Expert 3 | 10-NN | pct=100%] Retrieval MAE: 887.0358 | R-squared: 0.0806 | Avg. Confidence: 0.1750
[Expert 3 | 20-NN | pct=100%] Retrieval MAE: 867.1100 | R-squared: 0.1013 | Avg. Confidence: 0.0925
  - [Expert 3] RF (regression, 80/20): MAE=998.4311 | RMSE=1033.3088 | R2=0.1036 (cases=39169 | samples=54747)

--- Running PCA-kNN Baseline Comparison ---

üî¨ Starting PCA + k-NN Baseline Evaluation...
  - Applying PCA to 273732 embeddings...
  - Reduced dimension from 256 to 128
  - Applying PCA to 273732 embeddings...
  - Reduced dimension from 256 to 128

--- Evaluating PCA-kNN task: classification ---
[1-NN] PCA-kNN Accuracy: 0.9100 (on 200 queries)
[5-NN] PCA-kNN Accuracy: 0.9400 (on 200 queries)
[10-NN] PCA-kNN Accuracy: 0.9450 (on 200 queries)
[20-NN] PCA-kNN Accuracy: 0.9550 (on 200 queries)

--- Evaluating PCA-kNN task: regression ---
[1-NN] PCA-kNN MAE: 1552.6386 | R-squared: -0.2729
[5-NN] PCA-kNN MAE: 1153.4659 | R-squared: 0.1020
[10-NN] PCA-kNN MAE: 1100.5272 | R-squared: 0.1306
[20-NN] PCA-kNN MAE: 1110.7678 | R-squared: 0.0999



# Traditional

Warning: some classes have < 2 samples; disabling stratified split.
Log path: C:/billing.xes.gz
Activity key: concept:name
Activities: 18
Paths: 143
Samples (prefixes): 351359
Feature dimension: 164
Target classes: 18
Train size: 281087
Test size: 70272
Training sample %: 5
Train size (sampled): 14054
RF test accuracy: 0.8989
RF intra_centroid_cos (mean): 0.6936
RF inter_centroid_cos (mean): 0.1998
RF centroid_margin (mean): 0.0921
RF knn_purity@5 (mean): 0.7722
RF knn_purity@10 (mean): 0.7635
PCA+kNN (k=1) test accuracy: 0.7869 (components: 3)
PCA intra_centroid_cos (mean): 0.6936
PCA inter_centroid_cos (mean): 0.1998
PCA centroid_margin (mean): 0.0921
PCA knn_purity@5 (mean): 0.7716
PCA knn_purity@10 (mean): 0.7628
Training sample %: 20
Train size (sampled): 56217
RF test accuracy: 0.9062
RF intra_centroid_cos (mean): 0.6936
RF inter_centroid_cos (mean): 0.1998
RF centroid_margin (mean): 0.0921
RF knn_purity@5 (mean): 0.7722
RF knn_purity@10 (mean): 0.7635
PCA+kNN (k=1) test accuracy: 0.8005 (components: 3)
PCA intra_centroid_cos (mean): 0.6936
PCA inter_centroid_cos (mean): 0.1998
PCA centroid_margin (mean): 0.0921
PCA knn_purity@5 (mean): 0.7722
PCA knn_purity@10 (mean): 0.7638
Training sample %: 100
Train size (sampled): 281087
RF test accuracy: 0.9120
RF intra_centroid_cos (mean): 0.6936
RF inter_centroid_cos (mean): 0.1998
RF centroid_margin (mean): 0.0921
RF knn_purity@5 (mean): 0.7722
RF knn_purity@10 (mean): 0.7635
PCA+kNN (k=1) test accuracy: 0.8179 (components: 3)
PCA intra_centroid_cos (mean): 0.6936
PCA inter_centroid_cos (mean): 0.1998
PCA centroid_margin (mean): 0.0921
PCA knn_purity@5 (mean): 0.7718
PCA knn_purity@10 (mean): 0.7634

Log path: C:/billing.xes.gz
Activity key: concept:name
Timestamp key: time:timestamp
Activities: 18
Paths: 143
Samples (prefixes): 351359
Feature dimension: 164
Train size: 281087
Test size: 70272
Training sample %: 5
Train size (sampled): 14054
Per-case MAE (hours): 1077.8094
Per-case RMSE (hours): 1141.4391
R2: 0.0590
PCA+kNN (k=1) MAE (hours): 1313.7371 RMSE (hours): 1431.0305 R2: -0.6394 (components: 3)
Training sample %: 20
Train size (sampled): 56217
Per-case MAE (hours): 1042.8562
Per-case RMSE (hours): 1105.3384
R2: 0.0876
PCA+kNN (k=1) MAE (hours): 1279.3795 RMSE (hours): 1396.2040 R2: -0.5937 (components: 3)
Training sample %: 100
Train size (sampled): 281087
Per-case MAE (hours): 1007.9417
Per-case RMSE (hours): 1070.4653
R2: 0.1249
PCA+kNN (k=1) MAE (hours): 1203.0605 RMSE (hours): 1317.0471 R2: -0.4893 (components: 3)
